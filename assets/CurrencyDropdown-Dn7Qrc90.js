import{b as z}from"./QCard-DQFddnpL.js";import{Q as q,b as y,c as V}from"./QItemLabel-qHPq7E9M.js";import{c as I,C as $,Q as D}from"./index-CdrjR-oO.js";import{r as k,a as B,w as M,u as C,v as f,x as s,y as i,M as T,N as L,S as E,T as U,A as j,U as A,I as Q,P as F,as as J,J as O}from"./index-D5luScLF.js";const W={__name:"CurrencyDropdown",props:{modelValue:String,usedCurrencies:{type:Set,default:()=>new Set},buttonProps:{type:Object,default:()=>({})},expandable:{type:Boolean,default:!0},clear:{type:Boolean,default:!1},allowNoCurrency:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(v,{emit:x}){var g;const t=v,S=x,c=k(t.modelValue),d=k(((g=t.usedCurrencies)==null?void 0:g.size)>0),n=k(""),b=B(()=>t.expandable&&t.usedCurrencies.size>0),N=()=>{var l;d.value=((l=t.usedCurrencies)==null?void 0:l.size)>0,t.clear&&(c.value=null,S("update:modelValue",null))},p=I.data.map(({code:l,currency:a})=>({label:`${l} - ${a.length>15?a.slice(0,15)+"...":a}`,value:l})),_=B(()=>{var r,m,w,h;if(t.usedCurrencies.size===0){let e=p;const u=(r=n.value)==null?void 0:r.toLowerCase();return u&&(e=e.filter(({label:o})=>o.toLowerCase().includes(u))),t.allowNoCurrency&&!u&&(e=[{label:"No currency",value:null},...e]),e}if(!b.value){let e=p.filter(({value:o})=>t.usedCurrencies.has(o));const u=(m=n.value)==null?void 0:m.toLowerCase();return u&&(e=e.filter(({label:o})=>o.toLowerCase().includes(u))),e}if(!d.value){let e=p;const u=(w=n.value)==null?void 0:w.toLowerCase();return u&&(e=e.filter(({label:o})=>o.toLowerCase().includes(u))),e}let l=p.filter(({value:e})=>t.usedCurrencies.has(e));const a=(h=n.value)==null?void 0:h.toLowerCase();return a&&(l=l.filter(({label:e})=>e.toLowerCase().includes(a))),l});M(()=>t.modelValue,l=>{c.value=l});function P(l){c.value=l,S("update:modelValue",l)}return(l,a)=>(f(),C(O,J({label:v.buttonProps.label||(c.value===null?"No currency":c.value)||"Select currency"},v.buttonProps,{"icon-right":"arrow_drop_down"}),{default:s(()=>[i(q,{anchor:"bottom left",self:"top left",onBeforeShow:N,fit:!0},{default:s(()=>[i(y,null,{default:s(()=>[i(V,null,{default:s(()=>[i(z,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=r=>n.value=r),debounce:"300",label:"Search currencies",placeholder:"Type to filter",dense:"",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),(f(!0),T(E,null,U(_.value,(r,m)=>j((f(),C(y,{key:r.value,class:A(m%2===0?"bg-white":"bg-grey-3"),clickable:"",onClick:w=>P(r.value)},{default:s(()=>[i(V,null,{default:s(()=>[Q(F(r.label),1)]),_:2},1024)]),_:2},1032,["class","onClick"])),[[$]])),128)),d.value&&b.value?(f(),C(D,{key:0})):L("",!0),d.value&&b.value?(f(),C(y,{key:1,clickable:"",onClick:a[1]||(a[1]=r=>d.value=!1)},{default:s(()=>[i(V,null,{default:s(()=>[...a[2]||(a[2]=[Q("More...",-1)])]),_:1})]),_:1})):L("",!0)]),_:1})]),_:1},16,["label"]))}};export{W as _};
