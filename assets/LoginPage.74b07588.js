import{Q as P,b as y,a as S}from"./QCard.69fbfe9b.js";import{c as R,a as Q,h as g,b,g as L,O as N,r as v,u as f,v as p,x as r,T as U,y as a,M as x,U as A,aN as D,Q as I,a9 as q,N as w}from"./index.c885f364.js";import{u as $,a as j,Q as F,b as T}from"./QPage.f187342d.js";import{Q as _}from"./QCardActions.9546e846.js";import{Q as E}from"./QForm.b9ee7086.js";var G=R({name:"QBanner",props:{...$,inlineActions:Boolean,dense:Boolean,rounded:Boolean},setup(u,{slots:l}){const{proxy:{$q:d}}=L(),m=j(u,d),s=Q(()=>"q-banner row items-center"+(u.dense===!0?" q-banner--dense":"")+(m.value===!0?" q-banner--dark q-dark":"")+(u.rounded===!0?" rounded-borders":"")),i=Q(()=>`q-banner__actions row items-center justify-end col-${u.inlineActions===!0?"auto":"all"}`);return()=>{const o=[g("div",{class:"q-banner__avatar col-auto row items-center self-start"},b(l.avatar)),g("div",{class:"q-banner__content col text-body2"},b(l.default))],c=b(l.action);return c!==void 0&&o.push(g("div",{class:i.value},c)),g("div",{class:s.value+(u.inlineActions===!1&&c!==void 0?" q-banner--top-padding":""),role:"alert"},o)}}});const K=Object.assign({name:"LoginPage"},{__name:"LoginPage",setup(u){const l=N(),d=T(),m=U(),s=v(!1),i=v(""),o=v(""),c=v(""),h=[e=>!!e||"Please enter an email",e=>/.+@.+\..+/.test(e)||"Please enter a valid email"],C=[e=>!!e||"Please enter a password",e=>e.length>=6||"Password should be at least 6 characters"],V=async()=>{try{s.value?await l.register(i.value,o.value):await l.login(i.value,o.value),await l.init(),m.push({name:"IndexPage"})}catch(e){d.notify({message:e.message||e,color:"negative"}),e.code!=="auth/invalid-credential"&&await k()}},B=async()=>{try{await l.resetPassword(i.value),d.notify({message:"Email sent!"})}catch(e){d.notify({message:e.message||e,color:"negative"})}},k=async()=>{try{await l.clearFirebase(),m.push({name:"SettingsPage"})}catch(e){d.notify({message:e.message||e,color:"negative"})}};return(e,t)=>(f(),p(F,{class:"flex flex-center"},{default:r(()=>[a(S,{class:"q-pa-md",style:{width:"80%"}},{default:r(()=>[a(P,{class:"text-center",style:{"font-size":"28px"}},{default:r(()=>[x(A(s.value?"Register":"Login"),1)]),_:1}),a(E,{onSubmit:D(V,["prevent"])},{default:r(()=>[a(P,null,{default:r(()=>[s.value?(f(),p(G,{key:0,dense:"",class:"bg-orange-2 text-orange-10 q-mb-md"},{default:r(()=>[a(I,{name:"warning",class:"q-mr-sm"}),t[4]||(t[4]=x(" Using a fake email is at your own risk\u2014password recovery won't be possible. "))]),_:1})):q("",!0),a(y,{modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=n=>i.value=n),label:"Email",type:"email",rules:h,required:"",outlined:""},null,8,["modelValue"]),a(y,{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=n=>o.value=n),label:"Password",type:"password",rules:C,required:"",outlined:""},null,8,["modelValue"]),s.value?(f(),p(y,{key:1,modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]=n=>c.value=n),label:"Confirm Password",rules:[n=>n===o.value||"Passwords do not match"],type:"password",requireds:"",outlined:""},null,8,["modelValue","rules"])):q("",!0)]),_:1}),a(_,null,{default:r(()=>[a(w,{icon:"send",label:s.value?"Register":"Login",color:"primary",type:"submit",class:"full-width"},null,8,["label"])]),_:1})]),_:1}),a(_,{class:"justify-center"},{default:r(()=>[s.value?q("",!0):(f(),p(w,{key:0,label:"Forgot your password?",color:"primary",onClick:B,class:"full-width q-mt-md",icon:"key"})),a(w,{label:s.value?"Go to Login":"Go to Register",color:"secondary",onClick:t[3]||(t[3]=n=>s.value=!s.value),class:"full-width q-mt-md",icon:"account_circle"},null,8,["label"]),a(w,{label:"Settings",color:"secondary",onClick:k,class:"full-width q-mt-md",icon:"settings"})]),_:1})]),_:1})]),_:1}))}});export{K as default};
