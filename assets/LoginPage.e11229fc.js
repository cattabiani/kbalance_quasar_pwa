import{Q as b,b as f,a as C}from"./QCard.fe6f1c0f.js";import{O as h,r as d,u as m,v as c,x as o,T as R,y as a,M as Q,W as S,aN as _,Q as L,V as p,N as g}from"./index.a1fb33b4.js";import{Q as N}from"./QBanner.e97e49e7.js";import{Q as P}from"./QCardActions.6155bab7.js";import{Q as B}from"./QForm.f6e0e9b4.js";import{Q as U,b as F}from"./QPage.c03e9ce7.js";const $=Object.assign({name:"LoginPage"},{__name:"LoginPage",setup(I){const r=h(),u=F(),v=R(),l=d(!1),n=d(""),i=d(""),w=d(""),V=[e=>!!e||"Please enter an email",e=>/.+@.+\..+/.test(e)||"Please enter a valid email"],k=[e=>!!e||"Please enter a password",e=>e.length>=6||"Password should be at least 6 characters"],x=async()=>{try{l.value?await r.register(n.value,i.value):await r.login(n.value,i.value),await r.init(),v.push({name:"IndexPage"})}catch(e){u.notify({message:e.message||e,color:"negative"}),e.code!=="auth/invalid-credential"&&await y()}},q=async()=>{try{await r.resetPassword(n.value),u.notify({message:"Email sent!"})}catch(e){u.notify({message:e.message||e,color:"negative"})}},y=async()=>{try{await r.clearFirebase(),v.push({name:"SettingsPage"})}catch(e){u.notify({message:e.message||e,color:"negative"})}};return(e,s)=>(m(),c(U,{class:"flex flex-center"},{default:o(()=>[a(C,{class:"q-pa-md",style:{width:"80%"}},{default:o(()=>[a(b,{class:"text-center",style:{"font-size":"28px"}},{default:o(()=>[Q(S(l.value?"Register":"Login"),1)]),_:1}),a(B,{onSubmit:_(x,["prevent"])},{default:o(()=>[a(b,null,{default:o(()=>[l.value?(m(),c(N,{key:0,dense:"",class:"bg-orange-2 text-orange-10 q-mb-md"},{default:o(()=>[a(L,{name:"warning",class:"q-mr-sm"}),s[4]||(s[4]=Q(" Using a fake email is at your own risk\u2014password recovery won't be possible. "))]),_:1})):p("",!0),a(f,{modelValue:n.value,"onUpdate:modelValue":s[0]||(s[0]=t=>n.value=t),label:"Email",type:"email",rules:V,required:"",outlined:""},null,8,["modelValue"]),a(f,{modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=t=>i.value=t),label:"Password",type:"password",rules:k,required:"",outlined:""},null,8,["modelValue"]),l.value?(m(),c(f,{key:1,modelValue:w.value,"onUpdate:modelValue":s[2]||(s[2]=t=>w.value=t),label:"Confirm Password",rules:[t=>t===i.value||"Passwords do not match"],type:"password",requireds:"",outlined:""},null,8,["modelValue","rules"])):p("",!0)]),_:1}),a(P,null,{default:o(()=>[a(g,{icon:"send",label:l.value?"Register":"Login",color:"primary",type:"submit",class:"full-width"},null,8,["label"])]),_:1})]),_:1}),a(P,{class:"justify-center"},{default:o(()=>[l.value?p("",!0):(m(),c(g,{key:0,label:"Forgot your password?",color:"primary",onClick:q,class:"full-width q-mt-md",icon:"key"})),a(g,{label:l.value?"Go to Login":"Go to Register",color:"secondary",onClick:s[3]||(s[3]=t=>l.value=!l.value),class:"full-width q-mt-md",icon:"account_circle"},null,8,["label"]),a(g,{label:"Settings",color:"secondary",onClick:y,class:"full-width q-mt-md",icon:"settings"})]),_:1})]),_:1})]),_:1}))}});export{$ as default};
