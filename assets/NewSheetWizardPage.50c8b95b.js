import{_,ay as Q,r,w as P,u as S,$ as V,y as t,x as o,a0 as k,a1 as x,Z as y,Y as h,X as N,a2 as R,a3 as B}from"./index.4750bf8b.js";import{Q as C,a as I,b as $}from"./QList.569696fd.js";import{e as F,c as L,d as T,Q as z,f as U}from"./QPage.88ea25c0.js";import{Q as q}from"./QForm.50214d9f.js";import{_ as W}from"./PeopleList.e7ee2f1f.js";import"./QResizeObserver.89513726.js";import"./QSlideItem.f629f817.js";import"./ReceiveString.b9dc1656.js";import"./QCardActions.fb39df7a.js";import"./QDialog.99b45a56.js";import"./focusout.e554befa.js";import"./scroll.51770927.js";import"./PeopleDropdown.f9b46f41.js";import"./PersonItem.18940137.js";const j={class:"text-subtitle2"},oe=Object.assign({name:"PeoplePage"},{__name:"NewSheetWizardPage",setup(A){const s=_(),n=x(),i=L(),m=Q.user2person(s.user),d=r({[m.id]:m}),c=r(!0),u=r(""),p=r(null),f=r(null),g=r(null),v=()=>{n.go(-1)},b=async()=>{try{await s.logout(),n.push({name:"LoginPage"})}catch(l){i.notify({message:l.message||l,color:"negative"});return}};P(s.userLedger,async l=>{l===null&&await b()},{immediate:!0});const w=async()=>{if(!!await f.value.validate())try{const e=g.value.getPeople(),a=await s.addSheetFromNameAndPeople(u.value,e);i.notify(`Sheet ${a.name} added successfully`),await s.subscribeCurrentSheet(a.id),n.replace({name:"SheetPage"})}catch(e){i.notify({message:e.message||e,color:"negative"})}};return(l,e)=>(S(),V(k,null,[t(C,{elevated:"",class:"bg-primary text-white"},{default:o(()=>[t(I,null,{default:o(()=>[t(y,{flat:"",icon:"arrow_back",onClick:v,"aria-label":"Go Back",class:"bg-white text-primary"}),t($,{style:{"font-size":"28px"}},{default:o(()=>[e[4]||(e[4]=h(" New Sheet Wizard ")),N("div",j,R(B(s).user.email),1)]),_:1}),t(y,{flat:"",class:"q-ml-md bg-white text-primary",icon:"done",label:"Proceed",onClick:w})]),_:1})]),_:1}),t(F,null,{default:o(()=>[t(q,{ref_key:"formRef",ref:f},{default:o(()=>[t(T,null,{default:o(()=>[t(z,null,{default:o(()=>[t(U,{ref_key:"nameRef",ref:p,outlined:"",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=a=>u.value=a),onFocus:e[1]||(e[1]=a=>p.value.select()),rules:[a=>a&&a.length>0||"Name cannot be empty"],label:"Sheet Name"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512),t(W,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),seeInactive:c.value,"onUpdate:seeInactive":e[3]||(e[3]=a=>c.value=a),ref_key:"peopleListRef",ref:g},null,8,["modelValue","seeInactive"])]),_:1})],64))}});export{oe as default};
