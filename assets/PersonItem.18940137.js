import{r as q,F as Ce,ag as Y,z as Se,N as G,w as C,o as He,f as j,g as he,S as Me,j as D,L as We,c as Pe,a as k,P as qe,h as J,T as Be,b as Le,an as _e,E as Ae,_ as Fe,u as Z,$ as ze,y as ee,a3 as M,Q as $e,X as Re,x as te,Y as ne,a2 as oe,v as De,a6 as Oe}from"./index.4750bf8b.js";import{c as je,g as le}from"./QList.569696fd.js";import{p as ie,b as Ke,c as Ne,d as Qe,u as Ve,a as Ie,e as Ue,g as Xe,f as Ye,i as Ge,r as Je,h as ae,j as Ze,k as et}from"./focusout.e554befa.js";import{a as tt,b as nt,g as ot}from"./QPage.88ea25c0.js";import{c as lt,s as it,g as at}from"./scroll.51770927.js";const rt={target:{type:[Boolean,String,Element],default:!0},noParentEvent:Boolean},ut={...rt,contextMenu:Boolean};function st({showing:e,avoidEmit:n,configureAnchorEl:t}){const{props:o,proxy:l,emit:s}=he(),i=q(null);let d=null;function f(a){return i.value===null?!1:a===void 0||a.touches===void 0||a.touches.length<=1}const u={};t===void 0&&(Object.assign(u,{hide(a){l.hide(a)},toggle(a){l.toggle(a),a.qAnchorHandled=!0},toggleKey(a){Ce(a,13)===!0&&u.toggle(a)},contextClick(a){l.hide(a),Y(a),Se(()=>{l.show(a),a.qAnchorHandled=!0})},prevent:Y,mobileTouch(a){if(u.mobileCleanup(a),f(a)!==!0)return;l.hide(a),i.value.classList.add("non-selectable");const c=a.target;G(u,"anchor",[[c,"touchmove","mobileCleanup","passive"],[c,"touchend","mobileCleanup","passive"],[c,"touchcancel","mobileCleanup","passive"],[i.value,"contextmenu","prevent","notPassive"]]),d=setTimeout(()=>{d=null,l.show(a),a.qAnchorHandled=!0},300)},mobileCleanup(a){i.value.classList.remove("non-selectable"),d!==null&&(clearTimeout(d),d=null),e.value===!0&&a!==void 0&&je()}}),t=function(a=o.contextMenu){if(o.noParentEvent===!0||i.value===null)return;let c;a===!0?l.$q.platform.is.mobile===!0?c=[[i.value,"touchstart","mobileTouch","passive"]]:c=[[i.value,"mousedown","hide","passive"],[i.value,"contextmenu","contextClick","notPassive"]]:c=[[i.value,"click","toggle","passive"],[i.value,"keyup","toggleKey","passive"]],G(u,"anchor",c)});function h(){Me(u,"anchor")}function g(a){for(i.value=a;i.value.classList.contains("q-anchor--skip");)i.value=i.value.parentNode;t()}function x(){if(o.target===!1||o.target===""||l.$el.parentNode===null)i.value=null;else if(o.target===!0)g(l.$el.parentNode);else{let a=o.target;if(typeof o.target=="string")try{a=document.querySelector(o.target)}catch{a=void 0}a!=null?(i.value=a.$el||a,t()):(i.value=null,console.error(`Anchor: target "${o.target}" not found`))}}return C(()=>o.contextMenu,a=>{i.value!==null&&(h(),t(a))}),C(()=>o.target,()=>{i.value!==null&&h(),x()}),C(()=>o.noParentEvent,a=>{i.value!==null&&(a===!0?h():t())}),He(()=>{x(),n!==!0&&o.modelValue===!0&&i.value===null&&s("update:modelValue",!1)}),j(()=>{d!==null&&clearTimeout(d),h()}),{anchorEl:i,canShow:f,anchorEvents:u}}function ct(e,n){const t=q(null);let o;function l(d,f){const u=`${f!==void 0?"add":"remove"}EventListener`,h=f!==void 0?f:o;d!==window&&d[u]("scroll",h,D.passive),window[u]("scroll",h,D.passive),o=f}function s(){t.value!==null&&(l(t.value),t.value=null)}const i=C(()=>e.noParentEvent,()=>{t.value!==null&&(s(),n())});return j(i),{localScrollTarget:t,unconfigureScrollTarget:s,changeScrollEvent:l}}const{notPassiveCapture:B}=D,E=[];function L(e){const n=e.target;if(n===void 0||n.nodeType===8||n.classList.contains("no-pointer-events")===!0)return;let t=ie.length-1;for(;t>=0;){const o=ie[t].$;if(o.type.name==="QTooltip"){t--;continue}if(o.type.name!=="QDialog")break;if(o.props.seamless!==!0)return;t--}for(let o=E.length-1;o>=0;o--){const l=E[o];if((l.anchorEl.value===null||l.anchorEl.value.contains(n)===!1)&&(n===document.body||l.innerRef.value!==null&&l.innerRef.value.contains(n)===!1))e.qClickOutside=!0,l.onClickOutside(e);else return}}function dt(e){E.push(e),E.length===1&&(document.addEventListener("mousedown",L,B),document.addEventListener("touchstart",L,B))}function re(e){const n=E.findIndex(t=>t===e);n!==-1&&(E.splice(n,1),E.length===0&&(document.removeEventListener("mousedown",L,B),document.removeEventListener("touchstart",L,B)))}let ue,se;function ce(e){const n=e.split(" ");return n.length!==2?!1:["top","center","bottom"].includes(n[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(n[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function ft(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const O={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{O[`${e}#ltr`]=e,O[`${e}#rtl`]=e});function de(e,n){const t=e.split(" ");return{vertical:t[0],horizontal:O[`${t[1]}#${n===!0?"rtl":"ltr"}`]}}function ht(e,n){let{top:t,left:o,right:l,bottom:s,width:i,height:d}=e.getBoundingClientRect();return n!==void 0&&(t-=n[1],o-=n[0],s+=n[1],l+=n[0],i+=n[0],d+=n[1]),{top:t,bottom:s,height:d,left:o,right:l,width:i,middle:o+(l-o)/2,center:t+(s-t)/2}}function mt(e,n,t){let{top:o,left:l}=e.getBoundingClientRect();return o+=n.top,l+=n.left,t!==void 0&&(o+=t[1],l+=t[0]),{top:o,bottom:o+1,height:1,left:l,right:l+1,width:1,middle:l,center:o}}function vt(e,n){return{top:0,center:n/2,bottom:n,left:0,middle:e/2,right:e}}function fe(e,n,t,o){return{top:e[t.vertical]-n[o.vertical],left:e[t.horizontal]-n[o.horizontal]}}function me(e,n=0){if(e.targetEl===null||e.anchorEl===null||n>5)return;if(e.targetEl.offsetHeight===0||e.targetEl.offsetWidth===0){setTimeout(()=>{me(e,n+1)},10);return}const{targetEl:t,offset:o,anchorEl:l,anchorOrigin:s,selfOrigin:i,absoluteOffset:d,fit:f,cover:u,maxHeight:h,maxWidth:g}=e;if(We.is.ios===!0&&window.visualViewport!==void 0){const w=document.body.style,{offsetLeft:p,offsetTop:y}=window.visualViewport;p!==ue&&(w.setProperty("--q-pe-left",p+"px"),ue=p),y!==se&&(w.setProperty("--q-pe-top",y+"px"),se=y)}const{scrollLeft:x,scrollTop:a}=t,c=d===void 0?ht(l,u===!0?[0,0]:o):mt(l,d,o);Object.assign(t.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:g,maxHeight:h,visibility:"visible"});const{offsetWidth:W,offsetHeight:S}=t,{elWidth:P,elHeight:_}=f===!0||u===!0?{elWidth:Math.max(c.width,W),elHeight:u===!0?Math.max(c.height,S):S}:{elWidth:W,elHeight:S};let v={maxWidth:g,maxHeight:h};(f===!0||u===!0)&&(v.minWidth=c.width+"px",u===!0&&(v.minHeight=c.height+"px")),Object.assign(t.style,v);const b=vt(P,_);let m=fe(c,b,s,i);if(d===void 0||o===void 0)R(m,c,b,s,i);else{const{top:w,left:p}=m;R(m,c,b,s,i);let y=!1;if(m.top!==w){y=!0;const T=2*o[1];c.center=c.top-=T,c.bottom-=T+2}if(m.left!==p){y=!0;const T=2*o[0];c.middle=c.left-=T,c.right-=T+2}y===!0&&(m=fe(c,b,s,i),R(m,c,b,s,i))}v={top:m.top+"px",left:m.left+"px"},m.maxHeight!==void 0&&(v.maxHeight=m.maxHeight+"px",c.height>m.maxHeight&&(v.minHeight=v.maxHeight)),m.maxWidth!==void 0&&(v.maxWidth=m.maxWidth+"px",c.width>m.maxWidth&&(v.minWidth=v.maxWidth)),Object.assign(t.style,v),t.scrollTop!==a&&(t.scrollTop=a),t.scrollLeft!==x&&(t.scrollLeft=x)}function R(e,n,t,o,l){const s=t.bottom,i=t.right,d=lt(),f=window.innerHeight-d,u=document.body.clientWidth;if(e.top<0||e.top+s>f)if(l.vertical==="center")e.top=n[o.vertical]>f/2?Math.max(0,f-s):0,e.maxHeight=Math.min(s,f);else if(n[o.vertical]>f/2){const h=Math.min(f,o.vertical==="center"?n.center:o.vertical===l.vertical?n.bottom:n.top);e.maxHeight=Math.min(s,h),e.top=Math.max(0,h-s)}else e.top=Math.max(0,o.vertical==="center"?n.center:o.vertical===l.vertical?n.top:n.bottom),e.maxHeight=Math.min(s,f-e.top);if(e.left<0||e.left+i>u)if(e.maxWidth=Math.min(i,u),l.horizontal==="middle")e.left=n[o.horizontal]>u/2?Math.max(0,u-i):0;else if(n[o.horizontal]>u/2){const h=Math.min(u,o.horizontal==="middle"?n.middle:o.horizontal===l.horizontal?n.right:n.left);e.maxWidth=Math.min(i,h),e.left=Math.max(0,h-e.maxWidth)}else e.left=Math.max(0,o.horizontal==="middle"?n.middle:o.horizontal===l.horizontal?n.left:n.right),e.maxWidth=Math.min(i,u-e.left)}var wt=Pe({name:"QMenu",inheritAttrs:!1,props:{...ut,...Ke,...tt,...Ne,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:ce},self:{type:String,validator:ce},offset:{type:Array,validator:ft},scrollTarget:it,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...Qe,"click","escapeKey"],setup(e,{slots:n,emit:t,attrs:o}){let l=null,s,i,d;const f=he(),{proxy:u}=f,{$q:h}=u,g=q(null),x=q(!1),a=k(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),c=nt(e,h),{registerTick:W,removeTick:S}=Ve(),{registerTimeout:P}=Ie(),{transitionProps:_,transitionStyle:v}=Ue(e),{localScrollTarget:b,changeScrollEvent:m,unconfigureScrollTarget:w}=ct(e,U),{anchorEl:p,canShow:y}=st({showing:x}),{hide:T}=Xe({showing:x,canShow:y,handleShow:ye,handleHide:be,hideOnRouteChange:a,processOnMount:!0}),{showPortal:K,hidePortal:N,renderPortal:ve}=Ye(f,g,Ee,"menu"),A={anchorEl:p,innerRef:g,onClickOutside(r){if(e.persistent!==!0&&x.value===!0)return T(r),(r.type==="touchstart"||r.target.classList.contains("q-dialog__backdrop"))&&Ae(r),!0}},Q=k(()=>de(e.anchor||(e.cover===!0?"center middle":"bottom start"),h.lang.rtl)),ge=k(()=>e.cover===!0?Q.value:de(e.self||"top start",h.lang.rtl)),xe=k(()=>(e.square===!0?" q-menu--square":"")+(c.value===!0?" q-menu--dark q-dark":"")),pe=k(()=>e.autoClose===!0?{onClick:Te}:{}),V=k(()=>x.value===!0&&e.persistent!==!0);C(V,r=>{r===!0?(Ze(z),dt(A)):(ae(z),re(A))});function F(){ot(()=>{let r=g.value;r&&r.contains(document.activeElement)!==!0&&(r=r.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.querySelector("[autofocus], [data-autofocus]")||r,r.focus({preventScroll:!0}))})}function ye(r){if(l=e.noRefocus===!1?document.activeElement:null,Ge(X),K(),U(),s=void 0,r!==void 0&&(e.touchPosition||e.contextMenu)){const $=qe(r);if($.left!==void 0){const{top:we,left:ke}=p.value.getBoundingClientRect();s={left:$.left-ke,top:$.top-we}}}i===void 0&&(i=C(()=>h.screen.width+"|"+h.screen.height+"|"+e.self+"|"+e.anchor+"|"+h.lang.rtl,H)),e.noFocus!==!0&&document.activeElement.blur(),W(()=>{H(),e.noFocus!==!0&&F()}),P(()=>{h.platform.is.ios===!0&&(d=e.autoClose,g.value.click()),H(),K(!0),t("show",r)},e.transitionDuration)}function be(r){S(),N(),I(!0),l!==null&&(r===void 0||r.qClickOutside!==!0)&&(((r&&r.type.indexOf("key")===0?l.closest('[tabindex]:not([tabindex^="-"])'):void 0)||l).focus(),l=null),P(()=>{N(!0),t("hide",r)},e.transitionDuration)}function I(r){s=void 0,i!==void 0&&(i(),i=void 0),(r===!0||x.value===!0)&&(Je(X),w(),re(A),ae(z)),r!==!0&&(l=null)}function U(){(p.value!==null||e.scrollTarget!==void 0)&&(b.value=at(p.value,e.scrollTarget),m(b.value,H))}function Te(r){d!==!0?(et(u,r),t("click",r)):d=!1}function X(r){V.value===!0&&e.noFocus!==!0&&_e(g.value,r.target)!==!0&&F()}function z(r){t("escapeKey"),T(r)}function H(){me({targetEl:g.value,offset:e.offset,anchorEl:p.value,anchorOrigin:Q.value,selfOrigin:ge.value,absoluteOffset:s,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Ee(){return J(Be,_.value,()=>x.value===!0?J("div",{role:"menu",...o,ref:g,tabindex:-1,class:["q-menu q-position-engine scroll"+xe.value,o.class],style:[o.style,v.value],...pe.value},Le(n.default)):null)}return j(I),Object.assign(u,{focus:F,updatePosition:H}),ve}});const gt={class:"q-gutter-md",style:{display:"flex","align-items":"center"}},xt={style:{display:"flex","flex-direction":"column","align-items":"flex-start"}},kt={__name:"PersonItem",props:{id:{type:String,required:!0},people:{type:Object,default:null}},setup(e){const n=Fe(),t=e,o=l=>{var s,i,d,f,u;return!(((i=(s=t.people)==null?void 0:s[l])==null?void 0:i.active)===!1||((u=(f=(d=n.currentSheet)==null?void 0:d.people)==null?void 0:f[l])==null?void 0:u.active)===!1)};return(l,s)=>(Z(),ze("div",gt,[ee($e,{name:o(t.id)?"person":"person_off",color:M(n).isUserOrFriend(t.id)?"primary":"grey","aria-label":M(n).isUserOrFriend(t.id)?"Real user":"Fake user"},null,8,["name","color","aria-label"]),Re("div",xt,[ee(le,null,{default:te(()=>[ne(oe(M(n).getName(t.id,t==null?void 0:t.people)),1)]),_:1}),M(n).isCaption(t.id,t==null?void 0:t.people)?(Z(),De(le,{key:0,caption:""},{default:te(()=>[ne(oe(M(n).getEmail(t.id,t==null?void 0:t.people)),1)]),_:1})):Oe("",!0)])]))}};export{wt as Q,kt as _};
