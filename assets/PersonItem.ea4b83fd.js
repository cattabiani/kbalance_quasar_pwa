import{r as P,F as _e,ag as G,z as ke,N as X,w as _,o as He,f as V,g as me,S as Me,j as $,L as Be,c as Pe,a as C,P as Ae,h as J,T as We,b as qe,an as Fe,E as Ie,_ as De,u as Z,$ as Le,y as ee,a3 as T,Q as Re,X as $e,x as te,Y as ne,a2 as oe,v as ze,a6 as Ve}from"./index.709e3865.js";import{c as Oe,f as le}from"./QList.4b49d5b3.js";import{p as ie,b as Ne,c as Ke,d as je,u as Qe,a as Ue,e as Ye,g as Ge,f as Xe,i as Je,r as Ze,h as ae,j as et,k as tt}from"./focusout.97533d3d.js";import{a as nt,b as ot,g as lt}from"./QPage.503f05b2.js";import{c as it,s as at,g as rt}from"./scroll.5bc95592.js";const re={getDay(e){return new Date(e).getDate().toString().padStart(2,"0")},getMonth(e){const t=new Date(e);return new Intl.DateTimeFormat("en-GB",{month:"short"}).format(t)},getYear(e){return new Date(e).getFullYear()},displayCurrency(e,t){return`${e} ${parseFloat(t/100)}`},truncate(e){if(!e)return e;const t=13;return e.length>t?e.substring(0,t-3)+"...":e},isDev(){return!!{}.VITE_FIREBASE_API_KEY&&!!{}.VITE_FIREBASE_AUTH_DOMAIN&&!!{}.VITE_FIREBASE_PROJECT_ID&&!!{}.VITE_FIREBASE_STORAGE_BUCKET&&!!{}.VITE_FIREBASE_MESSAGING_SENDER_ID&&!!{}.VITE_FIREBASE_APP_ID}},ut={target:{type:[Boolean,String,Element],default:!0},noParentEvent:Boolean},st={...ut,contextMenu:Boolean};function ct({showing:e,avoidEmit:t,configureAnchorEl:n}){const{props:o,proxy:l,emit:s}=me(),i=P(null);let d=null;function f(a){return i.value===null?!1:a===void 0||a.touches===void 0||a.touches.length<=1}const u={};n===void 0&&(Object.assign(u,{hide(a){l.hide(a)},toggle(a){l.toggle(a),a.qAnchorHandled=!0},toggleKey(a){_e(a,13)===!0&&u.toggle(a)},contextClick(a){l.hide(a),G(a),ke(()=>{l.show(a),a.qAnchorHandled=!0})},prevent:G,mobileTouch(a){if(u.mobileCleanup(a),f(a)!==!0)return;l.hide(a),i.value.classList.add("non-selectable");const c=a.target;X(u,"anchor",[[c,"touchmove","mobileCleanup","passive"],[c,"touchend","mobileCleanup","passive"],[c,"touchcancel","mobileCleanup","passive"],[i.value,"contextmenu","prevent","notPassive"]]),d=setTimeout(()=>{d=null,l.show(a),a.qAnchorHandled=!0},300)},mobileCleanup(a){i.value.classList.remove("non-selectable"),d!==null&&(clearTimeout(d),d=null),e.value===!0&&a!==void 0&&Oe()}}),n=function(a=o.contextMenu){if(o.noParentEvent===!0||i.value===null)return;let c;a===!0?l.$q.platform.is.mobile===!0?c=[[i.value,"touchstart","mobileTouch","passive"]]:c=[[i.value,"mousedown","hide","passive"],[i.value,"contextmenu","contextClick","notPassive"]]:c=[[i.value,"click","toggle","passive"],[i.value,"keyup","toggleKey","passive"]],X(u,"anchor",c)});function h(){Me(u,"anchor")}function v(a){for(i.value=a;i.value.classList.contains("q-anchor--skip");)i.value=i.value.parentNode;n()}function x(){if(o.target===!1||o.target===""||l.$el.parentNode===null)i.value=null;else if(o.target===!0)v(l.$el.parentNode);else{let a=o.target;if(typeof o.target=="string")try{a=document.querySelector(o.target)}catch{a=void 0}a!=null?(i.value=a.$el||a,n()):(i.value=null,console.error(`Anchor: target "${o.target}" not found`))}}return _(()=>o.contextMenu,a=>{i.value!==null&&(h(),n(a))}),_(()=>o.target,()=>{i.value!==null&&h(),x()}),_(()=>o.noParentEvent,a=>{i.value!==null&&(a===!0?h():n())}),He(()=>{x(),t!==!0&&o.modelValue===!0&&i.value===null&&s("update:modelValue",!1)}),V(()=>{d!==null&&clearTimeout(d),h()}),{anchorEl:i,canShow:f,anchorEvents:u}}function dt(e,t){const n=P(null);let o;function l(d,f){const u=`${f!==void 0?"add":"remove"}EventListener`,h=f!==void 0?f:o;d!==window&&d[u]("scroll",h,$.passive),window[u]("scroll",h,$.passive),o=f}function s(){n.value!==null&&(l(n.value),n.value=null)}const i=_(()=>e.noParentEvent,()=>{n.value!==null&&(s(),t())});return V(i),{localScrollTarget:n,unconfigureScrollTarget:s,changeScrollEvent:l}}const{notPassiveCapture:A}=$,S=[];function W(e){const t=e.target;if(t===void 0||t.nodeType===8||t.classList.contains("no-pointer-events")===!0)return;let n=ie.length-1;for(;n>=0;){const o=ie[n].$;if(o.type.name==="QTooltip"){n--;continue}if(o.type.name!=="QDialog")break;if(o.props.seamless!==!0)return;n--}for(let o=S.length-1;o>=0;o--){const l=S[o];if((l.anchorEl.value===null||l.anchorEl.value.contains(t)===!1)&&(t===document.body||l.innerRef.value!==null&&l.innerRef.value.contains(t)===!1))e.qClickOutside=!0,l.onClickOutside(e);else return}}function ft(e){S.push(e),S.length===1&&(document.addEventListener("mousedown",W,A),document.addEventListener("touchstart",W,A))}function ue(e){const t=S.findIndex(n=>n===e);t!==-1&&(S.splice(t,1),S.length===0&&(document.removeEventListener("mousedown",W,A),document.removeEventListener("touchstart",W,A)))}let se,ce;function de(e){const t=e.split(" ");return t.length!==2?!1:["top","center","bottom"].includes(t[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(t[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function ht(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const z={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{z[`${e}#ltr`]=e,z[`${e}#rtl`]=e});function fe(e,t){const n=e.split(" ");return{vertical:n[0],horizontal:z[`${n[1]}#${t===!0?"rtl":"ltr"}`]}}function mt(e,t){let{top:n,left:o,right:l,bottom:s,width:i,height:d}=e.getBoundingClientRect();return t!==void 0&&(n-=t[1],o-=t[0],s+=t[1],l+=t[0],i+=t[0],d+=t[1]),{top:n,bottom:s,height:d,left:o,right:l,width:i,middle:o+(l-o)/2,center:n+(s-n)/2}}function gt(e,t,n){let{top:o,left:l}=e.getBoundingClientRect();return o+=t.top,l+=t.left,n!==void 0&&(o+=n[1],l+=n[0]),{top:o,bottom:o+1,height:1,left:l,right:l+1,width:1,middle:l,center:o}}function vt(e,t){return{top:0,center:t/2,bottom:t,left:0,middle:e/2,right:e}}function he(e,t,n,o){return{top:e[n.vertical]-t[o.vertical],left:e[n.horizontal]-t[o.horizontal]}}function ge(e,t=0){if(e.targetEl===null||e.anchorEl===null||t>5)return;if(e.targetEl.offsetHeight===0||e.targetEl.offsetWidth===0){setTimeout(()=>{ge(e,t+1)},10);return}const{targetEl:n,offset:o,anchorEl:l,anchorOrigin:s,selfOrigin:i,absoluteOffset:d,fit:f,cover:u,maxHeight:h,maxWidth:v}=e;if(Be.is.ios===!0&&window.visualViewport!==void 0){const w=document.body.style,{offsetLeft:E,offsetTop:p}=window.visualViewport;E!==se&&(w.setProperty("--q-pe-left",E+"px"),se=E),p!==ce&&(w.setProperty("--q-pe-top",p+"px"),ce=p)}const{scrollLeft:x,scrollTop:a}=n,c=d===void 0?mt(l,u===!0?[0,0]:o):gt(l,d,o);Object.assign(n.style,{top:0,left:0,minWidth:null,minHeight:null,maxWidth:v,maxHeight:h,visibility:"visible"});const{offsetWidth:M,offsetHeight:k}=n,{elWidth:B,elHeight:q}=f===!0||u===!0?{elWidth:Math.max(c.width,M),elHeight:u===!0?Math.max(c.height,k):k}:{elWidth:M,elHeight:k};let g={maxWidth:v,maxHeight:h};(f===!0||u===!0)&&(g.minWidth=c.width+"px",u===!0&&(g.minHeight=c.height+"px")),Object.assign(n.style,g);const y=vt(B,q);let m=he(c,y,s,i);if(d===void 0||o===void 0)R(m,c,y,s,i);else{const{top:w,left:E}=m;R(m,c,y,s,i);let p=!1;if(m.top!==w){p=!0;const b=2*o[1];c.center=c.top-=b,c.bottom-=b+2}if(m.left!==E){p=!0;const b=2*o[0];c.middle=c.left-=b,c.right-=b+2}p===!0&&(m=he(c,y,s,i),R(m,c,y,s,i))}g={top:m.top+"px",left:m.left+"px"},m.maxHeight!==void 0&&(g.maxHeight=m.maxHeight+"px",c.height>m.maxHeight&&(g.minHeight=g.maxHeight)),m.maxWidth!==void 0&&(g.maxWidth=m.maxWidth+"px",c.width>m.maxWidth&&(g.minWidth=g.maxWidth)),Object.assign(n.style,g),n.scrollTop!==a&&(n.scrollTop=a),n.scrollLeft!==x&&(n.scrollLeft=x)}function R(e,t,n,o,l){const s=n.bottom,i=n.right,d=it(),f=window.innerHeight-d,u=document.body.clientWidth;if(e.top<0||e.top+s>f)if(l.vertical==="center")e.top=t[o.vertical]>f/2?Math.max(0,f-s):0,e.maxHeight=Math.min(s,f);else if(t[o.vertical]>f/2){const h=Math.min(f,o.vertical==="center"?t.center:o.vertical===l.vertical?t.bottom:t.top);e.maxHeight=Math.min(s,h),e.top=Math.max(0,h-s)}else e.top=Math.max(0,o.vertical==="center"?t.center:o.vertical===l.vertical?t.top:t.bottom),e.maxHeight=Math.min(s,f-e.top);if(e.left<0||e.left+i>u)if(e.maxWidth=Math.min(i,u),l.horizontal==="middle")e.left=t[o.horizontal]>u/2?Math.max(0,u-i):0;else if(t[o.horizontal]>u/2){const h=Math.min(u,o.horizontal==="middle"?t.middle:o.horizontal===l.horizontal?t.right:t.left);e.maxWidth=Math.min(i,h),e.left=Math.max(0,h-e.maxWidth)}else e.left=Math.max(0,o.horizontal==="middle"?t.middle:o.horizontal===l.horizontal?t.left:t.right),e.maxWidth=Math.min(i,u-e.left)}var wt=Pe({name:"QMenu",inheritAttrs:!1,props:{...st,...Ne,...nt,...Ke,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:de},self:{type:String,validator:de},offset:{type:Array,validator:ht},scrollTarget:at,touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...je,"click","escapeKey"],setup(e,{slots:t,emit:n,attrs:o}){let l=null,s,i,d;const f=me(),{proxy:u}=f,{$q:h}=u,v=P(null),x=P(!1),a=C(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),c=ot(e,h),{registerTick:M,removeTick:k}=Qe(),{registerTimeout:B}=Ue(),{transitionProps:q,transitionStyle:g}=Ye(e),{localScrollTarget:y,changeScrollEvent:m,unconfigureScrollTarget:w}=dt(e,U),{anchorEl:E,canShow:p}=ct({showing:x}),{hide:b}=Ge({showing:x,canShow:p,handleShow:ye,handleHide:be,hideOnRouteChange:a,processOnMount:!0}),{showPortal:O,hidePortal:N,renderPortal:ve}=Xe(f,v,Se,"menu"),F={anchorEl:E,innerRef:v,onClickOutside(r){if(e.persistent!==!0&&x.value===!0)return b(r),(r.type==="touchstart"||r.target.classList.contains("q-dialog__backdrop"))&&Ie(r),!0}},K=C(()=>fe(e.anchor||(e.cover===!0?"center middle":"bottom start"),h.lang.rtl)),xe=C(()=>e.cover===!0?K.value:fe(e.self||"top start",h.lang.rtl)),Ee=C(()=>(e.square===!0?" q-menu--square":"")+(c.value===!0?" q-menu--dark q-dark":"")),pe=C(()=>e.autoClose===!0?{onClick:Te}:{}),j=C(()=>x.value===!0&&e.persistent!==!0);_(j,r=>{r===!0?(et(D),ft(F)):(ae(D),ue(F))});function I(){lt(()=>{let r=v.value;r&&r.contains(document.activeElement)!==!0&&(r=r.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||r.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||r.querySelector("[autofocus], [data-autofocus]")||r,r.focus({preventScroll:!0}))})}function ye(r){if(l=e.noRefocus===!1?document.activeElement:null,Je(Y),O(),U(),s=void 0,r!==void 0&&(e.touchPosition||e.contextMenu)){const L=Ae(r);if(L.left!==void 0){const{top:we,left:Ce}=E.value.getBoundingClientRect();s={left:L.left-Ce,top:L.top-we}}}i===void 0&&(i=_(()=>h.screen.width+"|"+h.screen.height+"|"+e.self+"|"+e.anchor+"|"+h.lang.rtl,H)),e.noFocus!==!0&&document.activeElement.blur(),M(()=>{H(),e.noFocus!==!0&&I()}),B(()=>{h.platform.is.ios===!0&&(d=e.autoClose,v.value.click()),H(),O(!0),n("show",r)},e.transitionDuration)}function be(r){k(),N(),Q(!0),l!==null&&(r===void 0||r.qClickOutside!==!0)&&(((r&&r.type.indexOf("key")===0?l.closest('[tabindex]:not([tabindex^="-"])'):void 0)||l).focus(),l=null),B(()=>{N(!0),n("hide",r)},e.transitionDuration)}function Q(r){s=void 0,i!==void 0&&(i(),i=void 0),(r===!0||x.value===!0)&&(Ze(Y),w(),ue(F),ae(D)),r!==!0&&(l=null)}function U(){(E.value!==null||e.scrollTarget!==void 0)&&(y.value=rt(E.value,e.scrollTarget),m(y.value,H))}function Te(r){d!==!0?(tt(u,r),n("click",r)):d=!1}function Y(r){j.value===!0&&e.noFocus!==!0&&Fe(v.value,r.target)!==!0&&I()}function D(r){n("escapeKey"),b(r)}function H(){ge({targetEl:v.value,offset:e.offset,anchorEl:E.value,anchorOrigin:K.value,selfOrigin:xe.value,absoluteOffset:s,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Se(){return J(We,q.value,()=>x.value===!0?J("div",{role:"menu",...o,ref:v,tabindex:-1,class:["q-menu q-position-engine scroll"+Ee.value,o.class],style:[o.style,g.value],...pe.value},qe(t.default)):null)}return V(Q),Object.assign(u,{focus:I,updatePosition:H}),ve}});const xt={class:"q-gutter-md",style:{display:"flex","align-items":"center"}},Et={style:{display:"flex","flex-direction":"column","align-items":"flex-start"}},Ct={__name:"PersonItem",props:{id:{type:String,required:!0},people:{type:Object,default:null}},setup(e){const t=De(),n=e,o=l=>{var s,i,d,f,u;return!(((i=(s=n.people)==null?void 0:s[l])==null?void 0:i.active)===!1||((u=(f=(d=t.currentSheet)==null?void 0:d.people)==null?void 0:f[l])==null?void 0:u.active)===!1)};return(l,s)=>(Z(),Le("div",xt,[ee(Re,{name:o(n.id)?"person":"person_off",color:T(t).isUserOrFriend(n.id)?"primary":"grey","aria-label":T(t).isUserOrFriend(n.id)?"Real user":"Fake user"},null,8,["name","color","aria-label"]),$e("div",Et,[ee(le,null,{default:te(()=>[ne(oe(T(re).truncate(T(t).getName(n.id,n==null?void 0:n.people))),1)]),_:1}),T(t).isCaption(n.id,n==null?void 0:n.people)?(Z(),ze(le,{key:0,caption:""},{default:te(()=>[ne(oe(T(re).truncate(T(t).getEmail(n.id,n==null?void 0:n.people))),1)]),_:1})):Ve("",!0)])]))}};export{wt as Q,re as U,Ct as _};
