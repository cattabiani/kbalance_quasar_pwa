import{K as w,L as C,r as _,a as r,W as d,Z as B,M as V,v as y,y as t,x as l,J as S,u as $,N as q,O as p,S as R}from"./index-CYG2IzWo.js";import{Q as N}from"./QSpace-DOIFWXm_.js";import{Q as T,a as I}from"./QHeader-CZvIJgU3.js";import{Q as O,a as g}from"./QCard-DI5g04FU.js";import{b as U,Q as j}from"./QPage-y6rv__Ta.js";import{_ as A}from"./PeopleDropdown-b6ueENDk.js";import{_ as E}from"./CurrencyDropdown-rasKFJqo.js";import{_ as G,a as z}from"./TransactionList-DfSXnw26.js";import"./QResizeObserver-DH6Lyl8P.js";import"./QItemLabel-DJ4175_z.js";import"./selection-EuKqAGgH.js";import"./focusout-CObUXZst.js";import"./scroll-sHdrKqgP.js";import"./PersonItem-DUs9hOAU.js";import"./index-BRoRvwsn.js";import"./CurrencyDisplay-CzpuhY6c.js";import"./QSlideItem-BPy0Kenu.js";import"./use-render-cache-rinsAykk.js";const ue=Object.assign({name:"SettlePage"},{__name:"SettlePage",setup(D){const e=w(),h=C(),b=U(),s=_(e.user.id),u=r(()=>e.personId2Idx(s.value)),x=r(()=>d.summary(e.currentSheetResults,u.value)),c=r(()=>new Set(Object.keys(x.value))),o=_(c.value.size>0?Array.from(c.value)[0]:"USD"),f=r(()=>{const a=B.settle(e.currentSheetResults.perCurrencyBalance[o.value],u.value,e.currentSheetPeople);return a.name=`ðŸ¤– settle ${e.getName(s.value)} (${o.value})`,a}),m=r(()=>e.currentSheet?{...e.currentSheet.transactions,[f.value.id]:f.value}:{}),k=r(()=>d.make(m.value,e.currentSheetPeople.length)),P=r(()=>d.summary(k.value,u.value)),v=()=>{h.go(-1)},Q=async()=>{try{await e.addTransactions(m.value),v()}catch(a){b.notify({message:a.message||a,color:"negative"});return}};return(a,n)=>(y(),V(R,null,[t(I,{elevated:"",class:"bg-primary text-white"},{default:l(()=>[t(T,null,{default:l(()=>[t(S,{flat:"",icon:"arrow_back",onClick:v,"aria-label":"Go Back",class:"bg-white text-primary"}),t(N),t(S,{flat:"",icon:"done",label:"Confirm",onClick:Q,class:"q-ml-md bg-secondary text-white","aria-label":"Save"})]),_:1})]),_:1}),t(j,null,{default:l(()=>[t(O,{class:"q-my-md q-mx-md row items-stretch q-gutter-x-md"},{default:l(()=>[t(g,{class:"col"},{default:l(()=>[p(e).currentSheet?(y(),$(A,{key:0,class:"full-width",modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=i=>s.value=i),people:p(e).currentSheet.people,"sorted-people":p(e).currentSheetPeople},null,8,["modelValue","people","sorted-people"])):q("",!0)]),_:1}),t(g,{class:"row items-stretch"},{default:l(()=>[t(E,{modelValue:o.value,"onUpdate:modelValue":n[1]||(n[1]=i=>o.value=i),usedCurrencies:c.value,expandable:!1,class:"text-subtitle1 full-height"},null,8,["modelValue","usedCurrencies"])]),_:1})]),_:1}),t(G,{summary:P.value,selectedPerson:s.value},null,8,["summary","selectedPerson"]),t(z,{transactions:m.value,selectedPerson:s.value,disableEdit:!0,disableRemove:!0},null,8,["transactions","selectedPerson"])]),_:1})],64))}});export{ue as default};
