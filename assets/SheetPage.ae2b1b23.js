import{_ as $,r as _,a as P,w as S,u as p,$ as N,y as t,x as l,a0 as E,a1 as R,Z as u,a2 as m,v as b,a3 as w,aC as L,aD as j}from"./index.7a2b63cf.js";import{Q as A}from"./QSpace.ce5a8250.js";import{Q as U,a as D}from"./PersonItem.61dacae3.js";import{e as F,c as G,d as H,Q as C,f as O}from"./QPage.c6dd2d1f.js";import{_ as Z}from"./PeopleDropdown.3d1cca06.js";import{_ as z,a as J}from"./TransactionList.53ccd66c.js";import"./focusout.1458f406.js";import"./scroll.b410d601.js";import"./QResizeObserver.e6dad4d0.js";import"./QSlideItem.45adbf0d.js";const ne=Object.assign({name:"SheetPage"},{__name:"SheetPage",setup(K){var h,y,v;const e=$(),o=R(),n=G(),i=_((v=(y=e.userLedger)==null?void 0:y.sheets[(h=e.currentSheet)==null?void 0:h.id])==null?void 0:v.name),c=_(e.user.id),k=P(()=>e.personId2Idx(c.value)),g=P(()=>L.getSummary(e.currentSheetResults,k.value)),x=async(a,s)=>{try{const r=`Are you sure you want to remove ${j.name(e.currentSheet.transactions[s])}?`;n.notify({message:r,timeout:0,actions:[{label:"Cancel",color:"white",handler:()=>a()},{label:"Confirm",color:"red",handler:async()=>{e.removeTransaction(s),n.notify({message:"Transaction removed successfully!"})}}]})}catch(r){n.notify({message:r.message||r,color:"negative"})}},Q=a=>{e.transactionId=a,o.push({name:"TransactionPage"})},T=()=>{e.transactionId=null,o.push({name:"TransactionPage"})},V=async()=>{try{await e.setSheetName(i.value)}catch(a){n.notify({message:a.message||a,color:"negative"})}},q=()=>{o.push({name:"PeoplePage"})},B=()=>{o.push({name:"ConvertPage"})},f=()=>{try{e.clearCurrentSheet(),o.go(-1)}catch(a){n.notify({message:a.message||a,color:"negative"});return}};S(e.currentSheet,async a=>{a===null&&f()},{immediate:!0});const I=async()=>{try{await e.logout(),o.push({name:"LoginPage"})}catch(a){n.notify({message:a.message||a,color:"negative"});return}};return S(e.userLedger,async a=>{a===null&&await I()},{immediate:!0}),(a,s)=>(p(),N(E,null,[t(U,{elevated:"",class:"bg-primary text-white"},{default:l(()=>[t(D,null,{default:l(()=>[t(u,{flat:"",icon:"arrow_back",onClick:f,"aria-label":"Go Back",class:"bg-white text-primary"}),t(A),t(u,{flat:"",icon:"people",onClick:q,label:"People",class:"q-ml-md bg-white text-primary","aria-label":"Edit people"})]),_:1})]),_:1}),t(F,null,{default:l(()=>{var r;return[t(H,{class:"q-my-md q-mr-md q-ml-md"},{default:l(()=>[t(C,{class:"row q-gutter-sm"},{default:l(()=>[m(e).currentSheet?(p(),b(Z,{key:0,class:"col-auto",modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=d=>c.value=d),people:m(e).currentSheet.people,"sorted-people":m(e).currentSheetPeople},null,8,["modelValue","people","sorted-people"])):w("",!0),t(O,{class:"col",modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=d=>i.value=d),onBlur:V,outlined:"",label:"Sheet Name"},null,8,["modelValue"])]),_:1})]),_:1}),t(z,{summaries:g.value,selectedPerson:c.value},null,8,["summaries","selectedPerson"]),t(C,{class:"row justify-center items-center"},{default:l(()=>[g.value.ans.length?(p(),b(u,{key:0,flat:"",class:"q-mr-md bg-purple text-white",icon:"currency_exchange",label:"Convert",onClick:B})):w("",!0),t(u,{flat:"",class:"bg-primary text-white",icon:"note_add",label:"Add Entry",onClick:T})]),_:1}),t(J,{transactions:((r=m(e).currentSheet)==null?void 0:r.transactions)||{},selectedPerson:c.value,onRemove:x,onEdit:Q},null,8,["transactions","selectedPerson"])]}),_:1})],64))}});export{ne as default};
