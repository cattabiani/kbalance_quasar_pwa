import{a as x,Q as V}from"./QCard.18e47f42.js";import{O as D,a as Q,u as o,P as I,v as f,x as n,L as y,W as r,U as e,V as h,S as Y,X as B,al as O,aD as q,Y as w,aE as $,M as k,y as p,Q as U}from"./index.905ce59a.js";import{U as l}from"./selection.2485ef98.js";import{c as M,b as T,d as C,a as z}from"./PersonItem.bb7b6b9a.js";import{Q as E}from"./QSlideItem.e5a5a424.js";const R={class:"q-pa-md"},A={key:0,style:{color:"green"}},F={key:1,style:{color:"red"}},W={class:"q-pa-md"},Z={__name:"SummaryCard",props:{summaries:{type:Object,required:!0},selectedPerson:{type:[String],required:!0}},setup(t){const v=D(),g=t,u=Q(()=>{const{ans:c,totals:s}=g.summaries;return{detail:c.map((L,j)=>({...L,id:j})),totals:s}}),P=Q(()=>Object.entries(u.value.totals).filter(([c,s])=>s>0).map(([c,s])=>l.displayCurrency(c,s)).join(" + ")),S=Q(()=>Object.entries(u.value.totals).filter(([c,s])=>s<0).map(([c,s])=>l.displayCurrency(c,-s)).join(" + "));return(c,s)=>(o(),I("div",null,[S.value||P.value?(o(),f(x,{key:0,class:"q-my-md q-mr-md q-ml-md"},{default:n(()=>[y("div",R,[S.value?(o(),I("div",A,r(e(v).getName(t.selectedPerson))+" is owed "+r(S.value),1)):h("",!0),P.value?(o(),I("div",F,r(e(v).getName(t.selectedPerson))+" owes "+r(P.value),1)):h("",!0)])]),_:1})):(o(),f(x,{key:1,class:"q-my-md q-mr-md q-ml-md"},{default:n(()=>s[0]||(s[0]=[y("div",{class:"q-pa-md"},[y("div",null,"All Settled!")],-1)])),_:1})),u.value&&u.value.detail.length>0?(o(),f(x,{key:2,class:"q-my-md q-mr-md q-ml-md"},{default:n(()=>[y("div",W,[(o(!0),I(Y,null,B(u.value.detail,i=>(o(),I("div",{key:i.id},[y("div",null,[y("span",null,r(i.amount>0?e(v).getName(t.selectedPerson):e(v).getName(e(v).personIdx2Id(i.person))),1),s[1]||(s[1]=y("span",null," owes ",-1)),y("span",null,r(i.amount<0?e(v).getName(t.selectedPerson):e(v).getName(e(v).personIdx2Id(i.person)))+" \xA0 ",1),y("span",{style:O({color:i.amount>0?"red":"green"})},r(e(l).displayCurrency(i.currency,Math.abs(i.amount))),5)])]))),128))])]),_:1})):h("",!0)]))}},_={__name:"TransactionList",props:{transactions:{type:Object,required:!0},selectedPerson:{type:String,required:!0},disableRemove:{type:Boolean,default:!1}},emits:["edit","remove"],setup(t,{emit:v}){const g=D(),u=t,P=d=>{if(d===0)return!1;const b=s.value[d-1],a=s.value[d],m=u.transactions[b].timestamp,N=u.transactions[a].timestamp;return l.getYear(m)!==l.getYear(N)||l.getMonth(m)!==l.getMonth(N)},S=d=>{const b=s.value[d],a=s.value[d-1],m=u.transactions[b].timestamp;return l.getYear(u.transactions[a].timestamp)!==l.getYear(m)?`${l.getMonth(m,!1)} ${l.getYear(m)}`:l.getMonth(m,!1)},c=Q(()=>g.personId2Idx(u.selectedPerson)),s=Q(()=>q.getTransactionList(u.transactions)),i=v,L=d=>{i("edit",d)},j=({reset:d},b)=>{i("remove",()=>d(),b)};return(d,b)=>(o(),f(z,null,{default:n(()=>[(o(!0),I(Y,null,B(s.value,(a,m)=>(o(),f(E,{key:a,clickable:"",class:w(m%2===0?"bg-grey-3":"bg-white"),onClick:N=>L(a),onLeft:N=>j(N,a),"left-color":"red","read-only":""},$({default:n(()=>[P(m)?(o(),f(M,{key:0,dense:"",dark:"",class:"bg-secondary text-bold text-white justify-center"},{default:n(()=>[k(r(S(m)),1)]),_:2},1024)):h("",!0),p(M,null,{default:n(()=>[p(x,{flat:"",bordered:"",class:"q-ml-sm q-mr-sm q-pl-sm q-pr-sm"},{default:n(()=>[p(V,{class:"column q-pa-none flex justify-center items-center"},{default:n(()=>[y("div",null,r(e(l).getMonth(t.transactions[a].timestamp)),1),y("div",null,r(e(l).getDay(t.transactions[a].timestamp)),1)]),_:2},1024)]),_:2},1024),p(T,null,{default:n(()=>[p(C,{class:w({"text-grey":e(g).pendingTransactionIds.has(a)})},{default:n(()=>[k(r(e(q).name(t.transactions[a])),1)]),_:2},1032,["class"]),p(C,{caption:""},{default:n(()=>[k(r(e(g).getName(e(g).personId2Idx(t.transactions[a].payer)))+" paid "+r(e(l).displayCurrency(t.transactions[a].currency,t.transactions[a].amount)),1)]),_:2},1024)]),_:2},1024),p(T,{side:""},{default:n(()=>[e(q).position(t.transactions[a],c.value)>0?(o(),f(C,{key:0,caption:"",style:{color:"green"}},{default:n(()=>[k(r(e(g).getName(t.selectedPerson))+" lent ",1)]),_:1})):h("",!0),e(q).position(t.transactions[a],c.value)<0?(o(),f(C,{key:1,caption:"",style:{color:"red"}},{default:n(()=>[k(r(e(g).getName(t.selectedPerson))+" borrowed ",1)]),_:1})):h("",!0),e(q).position(t.transactions[a],c.value)===0?(o(),f(C,{key:2},{default:n(()=>[k(r(c.value!==t.transactions[a].payer?"Not Involved":"Personal"),1)]),_:2},1024)):(o(),f(C,{key:3,style:O({color:e(q).position(t.transactions[a],c.value)>=0?"green":"red"})},{default:n(()=>[k(r(e(l).displayCurrency(t.transactions[a].currency,Math.abs(e(q).position(t.transactions[a],c.value)))),1)]),_:2},1032,["style"]))]),_:2},1024)]),_:2},1024)]),_:2},[t.disableRemove?void 0:{name:"left",fn:n(()=>[p(U,{name:"delete"})]),key:"0"}]),1032,["class","onClick","onLeft"]))),128))]),_:1}))}};export{Z as _,_ as a};
