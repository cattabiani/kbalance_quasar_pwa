import{a as x,Q as V}from"./QCard.61a4b2a6.js";import{O as D,a as Q,u as l,P as I,v as f,x as n,L as m,W as r,U as e,V as P,S as Y,X as B,an as O,aD as q,Y as w,aE as U,M as k,y as p,Q as z}from"./index.f3cf086f.js";import{U as c}from"./selection.c7c28661.js";import{c as M,b as T,d as C,a as E}from"./PersonItem.8fbbb191.js";import{Q as R}from"./QSlideItem.e2e851a5.js";const $={class:"q-pa-md"},A={key:0,style:{color:"green"}},F={key:1,style:{color:"red"}},W={class:"q-pa-md"},Z={__name:"SummaryCard",props:{summaries:{type:Object,required:!0},selectedPerson:{type:[String],required:!0}},setup(t){const y=D(),g=t,u=Q(()=>{const{ans:o,totals:s}=g.summaries;return{detail:o.map((L,j)=>({...L,id:j})),totals:s}}),S=Q(()=>Object.entries(u.value.totals).filter(([o,s])=>s>0).map(([o,s])=>c.displayCurrency(o,s)).join(" + ")),h=Q(()=>Object.entries(u.value.totals).filter(([o,s])=>s<0).map(([o,s])=>c.displayCurrency(o,-s)).join(" + "));return(o,s)=>(l(),I("div",null,[h.value||S.value?(l(),f(x,{key:0,class:"q-my-md q-mr-md q-ml-md"},{default:n(()=>[m("div",$,[h.value?(l(),I("div",A,r(e(y).getName(t.selectedPerson))+" is owed "+r(h.value),1)):P("",!0),S.value?(l(),I("div",F,r(e(y).getName(t.selectedPerson))+" owes "+r(S.value),1)):P("",!0)])]),_:1})):(l(),f(x,{key:1,class:"q-my-md q-mr-md q-ml-md"},{default:n(()=>s[0]||(s[0]=[m("div",{class:"q-pa-md"},[m("div",null,"All Settled!")],-1)])),_:1})),u.value&&u.value.detail.length>0?(l(),f(x,{key:2,class:"q-my-md q-mr-md q-ml-md"},{default:n(()=>[m("div",W,[(l(!0),I(Y,null,B(u.value.detail,i=>(l(),I("div",{key:i.id},[m("div",null,[m("span",null,r(i.amount>0?e(y).getName(t.selectedPerson):e(y).getName(e(y).personIdx2Id(i.person))),1),s[1]||(s[1]=m("span",null," owes ",-1)),m("span",null,r(i.amount<0?e(y).getName(t.selectedPerson):e(y).getName(e(y).personIdx2Id(i.person)))+" \xA0 ",1),m("span",{style:O({color:i.amount>0?"red":"green"})},r(e(c).displayCurrency(i.currency,Math.abs(i.amount))),5)])]))),128))])]),_:1})):P("",!0)]))}},_={__name:"TransactionList",props:{transactions:{type:Object,required:!0},selectedPerson:{type:String,required:!0},disableRemove:{type:Boolean,default:!1}},emits:["edit","remove"],setup(t,{emit:y}){const g=D(),u=t,S=d=>{if(d===0)return!1;const b=s.value[d-1],a=s.value[d],v=u.transactions[b].timestamp,N=u.transactions[a].timestamp;return c.getYear(v)!==c.getYear(N)||c.getMonth(v)!==c.getMonth(N)},h=d=>{const b=s.value[d],a=s.value[d-1],v=u.transactions[b].timestamp;return c.getYear(u.transactions[a].timestamp)!==c.getYear(v)?c.getYear(v):c.getMonth(v,!1)},o=Q(()=>g.personId2Idx(u.selectedPerson)),s=Q(()=>q.getTransactionList(u.transactions)),i=y,L=d=>{i("edit",d)},j=({reset:d},b)=>{i("remove",()=>d(),b)};return(d,b)=>(l(),f(E,null,{default:n(()=>[(l(!0),I(Y,null,B(s.value,(a,v)=>(l(),f(R,{key:a,clickable:"",class:w(v%2===0?"bg-grey-3":"bg-white"),onClick:N=>L(a),onLeft:N=>j(N,a),"left-color":"red","read-only":""},U({default:n(()=>[S(v)?(l(),f(M,{key:0,dense:"",dark:"",class:"bg-secondary text-bold text-white justify-center"},{default:n(()=>[k(r(h(v)),1)]),_:2},1024)):P("",!0),p(M,null,{default:n(()=>[p(x,{flat:"",bordered:"",class:"q-ml-sm q-mr-sm q-pl-sm q-pr-sm"},{default:n(()=>[p(V,{class:"column q-pa-none flex justify-center items-center"},{default:n(()=>[m("div",null,r(e(c).getMonth(t.transactions[a].timestamp)),1),m("div",null,r(e(c).getDay(t.transactions[a].timestamp)),1)]),_:2},1024)]),_:2},1024),p(T,null,{default:n(()=>[p(C,{class:w({"text-grey":e(g).pendingTransactionIds.has(a)})},{default:n(()=>[k(r(e(q).name(t.transactions[a])),1)]),_:2},1032,["class"]),p(C,{caption:""},{default:n(()=>[k(r(e(g).getName(e(g).personId2Idx(t.transactions[a].payer)))+" paid "+r(e(c).displayCurrency(t.transactions[a].currency,t.transactions[a].amount)),1)]),_:2},1024)]),_:2},1024),p(T,{side:""},{default:n(()=>[e(q).position(t.transactions[a],o.value)>0?(l(),f(C,{key:0,caption:"",style:{color:"green"}},{default:n(()=>[k(r(e(g).getName(t.selectedPerson))+" lent ",1)]),_:1})):P("",!0),e(q).position(t.transactions[a],o.value)<0?(l(),f(C,{key:1,caption:"",style:{color:"red"}},{default:n(()=>[k(r(e(g).getName(t.selectedPerson))+" borrowed ",1)]),_:1})):P("",!0),e(q).position(t.transactions[a],o.value)===0?(l(),f(C,{key:2},{default:n(()=>[k(r(o.value!==t.transactions[a].payer?"Not Involved":"Personal"),1)]),_:2},1024)):(l(),f(C,{key:3,style:O({color:e(q).position(t.transactions[a],o.value)>=0?"green":"red"})},{default:n(()=>[k(r(e(c).displayCurrency(t.transactions[a].currency,Math.abs(e(q).position(t.transactions[a],o.value)))),1)]),_:2},1032,["style"]))]),_:2},1024)]),_:2},1024)]),_:2},[t.disableRemove?void 0:{name:"left",fn:n(()=>[p(z,{name:"delete"})]),key:"0"}]),1032,["class","onClick","onLeft"]))),128))]),_:1}))}};export{Z as _,_ as a};
