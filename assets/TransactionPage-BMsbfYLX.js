import{c as he,a2 as fe,g as se,a3 as ge,r as R,a as I,ao as J,h as E,Q as ye,s as pe,b as ve,D as ee,w as le,ap as be,K as Z,M,v as D,y as a,u as P,N as j,O as l,aq as xe,H as L,P as X,S as W,I as te,L as Se,o as Fe,Z as H,x as b,J as O,A as Q,T as Ve,U as De,X as Ie}from"./index-D2HdZ1De.js";import{Q as we}from"./QSpace-EzNRA6m8.js";import{Q as Ce,a as ke}from"./QHeader-DJWfc0qY.js";import{f as _e,j as $e,b as ue,Q as ie,a as A}from"./QCard-BkOk9LnD.js";import{a as ne,b as G,c as N}from"./QItemLabel-BHPML9tK.js";import{Q as Ne,_ as re}from"./PeopleDropdown-rhZ6FGlr.js";import{u as Pe,a as qe,b as Ee,Q as Re}from"./QPage-CUzzjIzi.js";import{o as Me,u as Te,Q as Oe}from"./QCheckbox-DO8J7Ne9.js";import{C as z}from"./index-D5bWXMUs.js";import{_ as Ae}from"./PersonItem-D9mK8Gh-.js";import{_ as K}from"./CurrencyDisplay-BD4PQzTl.js";import{_ as Le}from"./CurrencyDropdown-DDkVKuv7.js";import"./QResizeObserver-DgO5pQvT.js";import"./selection-Bsyr-CGp.js";import"./focusout-DP5GSeAz.js";import"./scroll-avN9hMnx.js";import"./utils-bRICbQdu.js";const Qe=()=>E("svg",{key:"svg",class:"q-radio__bg absolute non-selectable",viewBox:"0 0 24 24"},[E("path",{d:"M12,22a10,10 0 0 1 -10,-10a10,10 0 0 1 10,-10a10,10 0 0 1 10,10a10,10 0 0 1 -10,10m0,-22a12,12 0 0 0 -12,12a12,12 0 0 0 12,12a12,12 0 0 0 12,-12a12,12 0 0 0 -12,-12"}),E("path",{class:"q-radio__check",d:"M12,6a6,6 0 0 0 -6,6a6,6 0 0 0 6,6a6,6 0 0 0 6,-6a6,6 0 0 0 -6,-6"})]),Ge=he({name:"QRadio",props:{...Pe,...fe,..._e,modelValue:{required:!0},val:{required:!0},label:String,leftLabel:Boolean,checkedIcon:String,uncheckedIcon:String,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},emits:["update:modelValue"],setup(n,{slots:e,emit:t}){const{proxy:r}=se(),i=qe(n,r.$q),h=ge(n,Me),m=R(null),{refocusTargetEl:g,refocusTarget:f}=Te(n,m),d=I(()=>J(n.modelValue)===J(n.val)),u=I(()=>"q-radio cursor-pointer no-outline row inline no-wrap items-center"+(n.disable===!0?" disabled":"")+(i.value===!0?" q-radio--dark":"")+(n.dense===!0?" q-radio--dense":"")+(n.leftLabel===!0?" reverse":"")),c=I(()=>{const x=n.color!==void 0&&(n.keepColor===!0||d.value===!0)?` text-${n.color}`:"";return`q-radio__inner relative-position q-radio__inner--${d.value===!0?"truthy":"falsy"}${x}`}),y=I(()=>(d.value===!0?n.checkedIcon:n.uncheckedIcon)||null),v=I(()=>n.disable===!0?-1:n.tabindex||0),F=I(()=>{const x={type:"radio"};return n.name!==void 0&&Object.assign(x,{".checked":d.value===!0,"^checked":d.value===!0?"checked":void 0,name:n.name,value:n.val}),x}),w=$e(F);function k(x){x!==void 0&&(ee(x),f(x)),n.disable!==!0&&d.value!==!0&&t("update:modelValue",n.val,x)}function C(x){(x.keyCode===13||x.keyCode===32)&&ee(x)}function p(x){(x.keyCode===13||x.keyCode===32)&&k(x)}Object.assign(r,{set:k});const _=Qe();return()=>{const x=y.value!==null?[E("div",{key:"icon",class:"q-radio__icon-container absolute-full flex flex-center no-wrap"},[E(ye,{class:"q-radio__icon",name:y.value})])]:[_];n.disable!==!0&&w(x,"unshift"," q-radio__native q-ma-none q-pa-none");const s=[E("div",{class:c.value,style:h.value,"aria-hidden":"true"},x)];g.value!==null&&s.push(g.value);const o=n.label!==void 0?pe(e.default,[n.label]):ve(e.default);return o!==void 0&&s.push(E("div",{class:"q-radio__label q-anchor--skip"},o)),E("div",{ref:m,class:u.value,tabindex:v.value,role:"radio","aria-label":n.label,"aria-checked":d.value===!0?"true":"false","aria-disabled":n.disable===!0?"true":void 0,onClick:k,onKeydown:C,onKeyup:p},s)}}});/**
 * Vue Currency Input 3.2.1
 * (c) 2018-2025 Matthias Stiller
 * @license MIT
 */var T;(function(n){n.symbol="symbol",n.narrowSymbol="narrowSymbol",n.code="code",n.name="name",n.hidden="hidden"})(T||(T={}));var q;(function(n){n.precision="precision",n.thousands="thousands",n.tenThousands="tenThousands",n.millions="millions",n.billions="billions"})(q||(q={}));const U=n=>n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ce=n=>n.replace(/^0+(0$|[^0])/,"$1"),Y=(n,e)=>(n.match(new RegExp(U(e),"g"))||[]).length,Be=(n,e)=>n.substring(0,n.indexOf(e)),me=[",",".","٫","。"],ae="(0|[1-9]\\d*)";class ze{constructor(e){var t,r,i,h,m,g;const{currency:f,currencyDisplay:d,locale:u,precision:c,accountingSign:y,useGrouping:v}=e;this.locale=u,this.options={currency:f,useGrouping:v,style:"currency",currencySign:y?"accounting":void 0,currencyDisplay:d!==T.hidden?d:void 0};const F=new Intl.NumberFormat(u,this.options),w=F.formatToParts(123456);this.currency=(t=w.find(({type:p})=>p==="currency"))===null||t===void 0?void 0:t.value,this.digits=[0,1,2,3,4,5,6,7,8,9].map(p=>p.toLocaleString(u)),this.decimalSymbol=(r=w.find(({type:p})=>p==="decimal"))===null||r===void 0?void 0:r.value,this.groupingSymbol=(i=w.find(({type:p})=>p==="group"))===null||i===void 0?void 0:i.value,this.minusSign=(h=F.formatToParts(-1).find(({type:p})=>p==="minusSign"))===null||h===void 0?void 0:h.value,this.decimalSymbol===void 0?this.minimumFractionDigits=this.maximumFractionDigits=0:typeof c=="number"?this.minimumFractionDigits=this.maximumFractionDigits=c:(this.minimumFractionDigits=(m=c==null?void 0:c.min)!==null&&m!==void 0?m:F.resolvedOptions().minimumFractionDigits,this.maximumFractionDigits=(g=c==null?void 0:c.max)!==null&&g!==void 0?g:F.resolvedOptions().maximumFractionDigits);const k=p=>Be(p,this.digits[1]),C=p=>p.substring(p.lastIndexOf(this.decimalSymbol?this.digits[0]:this.digits[1])+1);this.prefix=k(F.format(1)),this.suffix=C(F.format(1)),this.negativePrefix=k(F.format(-1)),this.negativeSuffix=C(F.format(-1))}parse(e){if(e){const t=this.isNegative(e);e=this.normalizeDigits(e),e=this.stripCurrency(e,t),e=this.stripSignLiterals(e);const r=this.decimalSymbol?`(?:${U(this.decimalSymbol)}(\\d*))?`:"",i=this.stripGroupingSeparator(e).match(new RegExp(`^${ae}${r}$`));if(i&&this.isValidIntegerFormat(this.decimalSymbol?e.split(this.decimalSymbol)[0]:e,Number(i[1])))return+`${t?"-":""}${this.onlyDigits(i[1])}.${this.onlyDigits(i[2]||"")}`}return null}isValidIntegerFormat(e,t){const r={...this.options,minimumFractionDigits:0};return[this.stripCurrency(this.normalizeDigits(t.toLocaleString(this.locale,{...r,useGrouping:!0})),!1),this.stripCurrency(this.normalizeDigits(t.toLocaleString(this.locale,{...r,useGrouping:!1})),!1)].includes(e)}format(e,t={minimumFractionDigits:this.minimumFractionDigits,maximumFractionDigits:this.maximumFractionDigits}){return e!=null?e.toLocaleString(this.locale,{...this.options,...t}):""}toFraction(e){return`${this.digits[0]}${this.decimalSymbol}${this.onlyLocaleDigits(e.substring(1)).substring(0,this.maximumFractionDigits)}`}isFractionIncomplete(e){return!!this.normalizeDigits(this.stripGroupingSeparator(e)).match(new RegExp(`^${ae}${U(this.decimalSymbol)}$`))}isNegative(e){return e.startsWith(this.negativePrefix)||this.minusSign===void 0&&(e.startsWith("(")||e.startsWith("-"))||this.minusSign!==void 0&&e.replace("-",this.minusSign).startsWith(this.minusSign)}insertCurrency(e,t){return`${t?this.negativePrefix:this.prefix}${e}${t?this.negativeSuffix:this.suffix}`}stripGroupingSeparator(e){return this.groupingSymbol!==void 0?e.replace(new RegExp(U(this.groupingSymbol),"g"),""):e}stripSignLiterals(e){return this.minusSign!==void 0?e.replace("-",this.minusSign).replace(this.minusSign,""):e.replace(/[-()]/g,"")}stripCurrency(e,t){return e.replace(t?this.negativePrefix:this.prefix,"").replace(t?this.negativeSuffix:this.suffix,"")}normalizeDecimalSeparator(e,t){return me.forEach(r=>{e=e.substring(0,t)+e.substring(t).replace(r,this.decimalSymbol)}),e}normalizeDigits(e){return this.digits[0]!=="0"&&this.digits.forEach((t,r)=>{e=e.replace(new RegExp(t,"g"),String(r))}),e}onlyDigits(e){return this.normalizeDigits(e).replace(/\D+/g,"")}onlyLocaleDigits(e){return e.replace(new RegExp(`[^${this.digits.join("")}]*`,"g"),"")}}class de{constructor(e){this.currencyFormat=e}}class Ue extends de{conformToMask(e,t=""){const r=this.currencyFormat.isNegative(e),i=F=>F===""&&r&&!(this.currencyFormat.minusSign===void 0?t===this.currencyFormat.negativePrefix+this.currencyFormat.negativeSuffix:t===this.currencyFormat.negativePrefix),h=F=>{if(i(F))return"";if(this.currencyFormat.maximumFractionDigits>0){if(this.currencyFormat.isFractionIncomplete(F))return F;if(F.startsWith(this.currencyFormat.decimalSymbol))return this.currencyFormat.toFraction(F)}return null};let m=e;m=this.currencyFormat.stripCurrency(m,r),m=this.currencyFormat.stripSignLiterals(m);const g=h(m);if(g!=null)return this.currencyFormat.insertCurrency(g,r);const[f,...d]=m.split(this.currencyFormat.decimalSymbol),u=ce(this.currencyFormat.onlyDigits(f)),c=this.currencyFormat.onlyDigits(d.join("")).substring(0,this.currencyFormat.maximumFractionDigits),y=d.length>0&&c.length===0,v=u===""&&r&&(this.currencyFormat.minusSign===void 0?t===e.slice(0,-2)+this.currencyFormat.negativeSuffix:t===e.slice(0,-1));return y||v||i(u)?t:u.match(/\d+/)?{numberValue:+`${r?"-":""}${u}.${c}`,fractionDigits:c}:""}}class je extends de{conformToMask(e,t=""){if(e===""||this.currencyFormat.parse(t)===0&&this.currencyFormat.stripCurrency(t,!0).slice(0,-1)===this.currencyFormat.stripCurrency(e,!0))return"";const r=this.currencyFormat.isNegative(e),i=this.currencyFormat.stripSignLiterals(e)===""?-0:+`${r?"-":""}${ce(this.currencyFormat.onlyDigits(e))}`/Math.pow(10,this.currencyFormat.maximumFractionDigits);return{numberValue:i,fractionDigits:i.toFixed(this.currencyFormat.maximumFractionDigits).slice(-this.currencyFormat.maximumFractionDigits)}}}const We={locale:void 0,currency:void 0,currencyDisplay:void 0,hideGroupingSeparatorOnFocus:!0,hideCurrencySymbolOnFocus:!0,hideNegligibleDecimalDigitsOnFocus:!0,precision:void 0,autoDecimalDigits:!1,valueRange:void 0,useGrouping:void 0,valueScaling:void 0};class Xe{constructor(e){this.el=e.el,this.onInput=e.onInput,this.onChange=e.onChange,this.addEventListener(),this.init(e.options)}setOptions(e){this.init(e),this.format(this.currencyFormat.format(this.validateValueRange(this.numberValue))),this.onChange(this.getValue())}getValue(){return{number:this.valueScaling&&this.numberValue!=null?this.toInteger(this.numberValue,this.valueScaling):this.numberValue,formatted:this.formattedValue}}setValue(e){const t=this.valueScaling!==void 0&&e!=null?this.toFloat(e,this.valueScaling):e;t!==this.numberValue&&(this.format(this.currencyFormat.format(this.validateValueRange(t))),this.onChange(this.getValue()))}init(e){this.options={...We,...e},this.options.autoDecimalDigits&&(this.options.hideNegligibleDecimalDigitsOnFocus=!1),this.el.getAttribute("inputmode")||this.el.setAttribute("inputmode",this.options.autoDecimalDigits?"numeric":"decimal"),this.currencyFormat=new ze(this.options),this.numberMask=this.options.autoDecimalDigits?new je(this.currencyFormat):new Ue(this.currencyFormat);const t={[q.precision]:this.currencyFormat.maximumFractionDigits,[q.thousands]:3,[q.tenThousands]:4,[q.millions]:6,[q.billions]:9};this.valueScaling=this.options.valueScaling?t[this.options.valueScaling]:void 0,this.valueScalingFractionDigits=this.valueScaling!==void 0&&this.options.valueScaling!==q.precision?this.valueScaling+this.currencyFormat.maximumFractionDigits:this.currencyFormat.maximumFractionDigits,this.minValue=this.getMinValue(),this.maxValue=this.getMaxValue()}getMinValue(){var e,t;let r=this.toFloat(-Number.MAX_SAFE_INTEGER);return((e=this.options.valueRange)===null||e===void 0?void 0:e.min)!==void 0&&(r=Math.max((t=this.options.valueRange)===null||t===void 0?void 0:t.min,this.toFloat(-Number.MAX_SAFE_INTEGER))),r}getMaxValue(){var e,t;let r=this.toFloat(Number.MAX_SAFE_INTEGER);return((e=this.options.valueRange)===null||e===void 0?void 0:e.max)!==void 0&&(r=Math.min((t=this.options.valueRange)===null||t===void 0?void 0:t.max,this.toFloat(Number.MAX_SAFE_INTEGER))),r}toFloat(e,t){return e/Math.pow(10,t!=null?t:this.valueScalingFractionDigits)}toInteger(e,t){return Number(e.toFixed(t!=null?t:this.valueScalingFractionDigits).split(".").join(""))}validateValueRange(e){return e!=null?Math.min(Math.max(e,this.minValue),this.maxValue):e}format(e,t=!1){if(e!=null){this.decimalSymbolInsertedAt!==void 0&&(e=this.currencyFormat.normalizeDecimalSeparator(e,this.decimalSymbolInsertedAt),this.decimalSymbolInsertedAt=void 0);const r=this.numberMask.conformToMask(e,this.formattedValue);let i;if(typeof r=="object"){const{numberValue:h,fractionDigits:m}=r;let{maximumFractionDigits:g,minimumFractionDigits:f}=this.currencyFormat;this.focus?f=t?m.replace(/0+$/,"").length:Math.min(g,m.length):Number.isInteger(h)&&!this.options.autoDecimalDigits&&(this.options.precision===void 0||f===0)&&(f=g=0),i=this.toInteger(Math.abs(h))>Number.MAX_SAFE_INTEGER?this.formattedValue:this.currencyFormat.format(h,{useGrouping:this.options.useGrouping!==!1&&!(this.focus&&this.options.hideGroupingSeparatorOnFocus),minimumFractionDigits:f,maximumFractionDigits:g})}else i=r;this.maxValue<=0&&!this.currencyFormat.isNegative(i)&&this.currencyFormat.parse(i)!==0&&(i=i.replace(this.currencyFormat.prefix,this.currencyFormat.negativePrefix)),this.minValue>=0&&(i=i.replace(this.currencyFormat.negativePrefix,this.currencyFormat.prefix)),(this.options.currencyDisplay===T.hidden||this.focus&&this.options.hideCurrencySymbolOnFocus)&&(i=i.replace(this.currencyFormat.negativePrefix,this.currencyFormat.minusSign!==void 0?this.currencyFormat.minusSign:"(").replace(this.currencyFormat.negativeSuffix,this.currencyFormat.minusSign!==void 0?"":")").replace(this.currencyFormat.prefix,"").replace(this.currencyFormat.suffix,"")),this.el.value=i,this.numberValue=this.currencyFormat.parse(i)}else this.el.value="",this.numberValue=null;this.formattedValue=this.el.value,this.onInput(this.getValue())}addEventListener(){this.el.addEventListener("input",e=>{const{value:t,selectionStart:r}=this.el,i=e;if(r&&i.data&&me.includes(i.data)&&(this.decimalSymbolInsertedAt=r-1),this.format(t),this.focus&&r!=null){const h=()=>{const{prefix:m,suffix:g,decimalSymbol:f,maximumFractionDigits:d,groupingSymbol:u}=this.currencyFormat;let c=t.length-r;const y=this.formattedValue.length;if(this.currencyFormat.minusSign===void 0&&(t.startsWith("(")||t.startsWith("-"))&&!t.endsWith(")"))return y-this.currencyFormat.negativeSuffix.length>1?this.formattedValue.substring(r).length:1;if(this.formattedValue.substring(r,1)===u&&Y(this.formattedValue,u)===Y(t,u)+1)return y-c-1;if(y<c)return r;if(f!==void 0&&t.indexOf(f)!==-1){const v=t.indexOf(f)+1;if(Math.abs(y-t.length)>1&&r<=v)return this.formattedValue.indexOf(f)+1;!this.options.autoDecimalDigits&&r>v&&this.currencyFormat.onlyDigits(t.substring(v)).length-1===d&&(c-=1)}return this.options.hideCurrencySymbolOnFocus||this.options.currencyDisplay===T.hidden?y-c:Math.max(y-Math.max(c,g.length),m.length)};this.setCaretPosition(h())}}),this.el.addEventListener("focus",()=>{this.focus=!0,this.numberValueOnFocus=this.numberValue,setTimeout(()=>{const{value:e,selectionStart:t,selectionEnd:r}=this.el;if(this.format(e,this.options.hideNegligibleDecimalDigitsOnFocus),t!=null&&r!=null&&Math.abs(t-r)>0)this.setCaretPosition(0,this.el.value.length);else if(t!=null){const i=this.getCaretPositionOnFocus(e,t);this.setCaretPosition(i)}})}),this.el.addEventListener("blur",()=>{this.focus=!1,this.format(this.currencyFormat.format(this.validateValueRange(this.numberValue))),this.numberValueOnFocus!==this.numberValue&&this.onChange(this.getValue())})}getCaretPositionOnFocus(e,t){if(this.numberValue==null)return t;const{prefix:r,negativePrefix:i,suffix:h,negativeSuffix:m,groupingSymbol:g,currency:f}=this.currencyFormat,d=this.numberValue<0,u=d?i:r,c=u.length;if(this.options.hideCurrencySymbolOnFocus||this.options.currencyDisplay===T.hidden){if(d){if(t<=1)return 1;if(e.endsWith(")")&&t>e.indexOf(")"))return this.formattedValue.length-1}}else{const v=d?m.length:h.length;if(t>=e.length-v)return this.formattedValue.length-v;if(t<c)return c}let y=t;return this.options.hideCurrencySymbolOnFocus&&this.options.currencyDisplay!==T.hidden&&t>=c&&f!==void 0&&u.includes(f)&&(y-=c,d&&(y+=1)),this.options.hideGroupingSeparatorOnFocus&&g!==void 0&&(y-=Y(e.substring(0,t),g)),y}setCaretPosition(e,t=e){this.el.setSelectionRange(e,t)}}const He=n=>n!=null&&n.matches("input")?n:n==null?void 0:n.querySelector("input");function Ye(n,e){var t,r,i,h;let m;const g=R(null),f=R(null),d=R(null),u=se(),c=(u==null?void 0:u.emit)||((r=(t=u==null?void 0:u.proxy)===null||t===void 0?void 0:t.$emit)===null||r===void 0?void 0:r.bind(u==null?void 0:u.proxy)),y=(u==null?void 0:u.props)||((i=u==null?void 0:u.proxy)===null||i===void 0?void 0:i.$props),v=be.startsWith("3"),F=v&&((h=u==null?void 0:u.attrs.modelModifiers)===null||h===void 0?void 0:h.lazy),w=I(()=>y==null?void 0:y[v?"modelValue":"value"]),k=v?"update:modelValue":"input",C=F?"update:modelValue":"change";return le(g,p=>{var _;if(p){const x=He((_=p==null?void 0:p.$el)!==null&&_!==void 0?_:p);x?(m=new Xe({el:x,options:n,onInput:s=>{!F&&e!==!1&&w.value!==s.number&&(c==null||c(k,s.number)),d.value=s.number,f.value=s.formatted},onChange:s=>{c==null||c(C,s.number)}}),m.setValue(w.value)):console.error('No input element found. Please make sure that the "inputRef" template ref is properly assigned.')}else m=null}),{inputRef:g,numberValue:d,formattedValue:f,setValue:p=>m==null?void 0:m.setValue(p),setOptions:p=>m==null?void 0:m.setOptions(p)}}const oe={__name:"CurrencyInput",props:{modelValue:Number,currency:String,label:String,alignRight:{type:Boolean,default:!1},bgColor:{type:String,default:""},readonly:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(n,{emit:e}){const t=Z(),r=n,{inputRef:i,formattedValue:h,setValue:m}=Ye({currency:"XXX",currencyDisplay:"hidden",valueScaling:"precision",valueRange:{min:0,max:void 0},autoSign:!0,locale:"it-CH"});return le(()=>r.modelValue,g=>{m(g)}),(g,f)=>(D(),M("div",null,[a(ue,{ref_key:"inputRef",ref:i,modelValue:l(h),"onUpdate:modelValue":f[0]||(f[0]=d=>xe(h)?h.value=d:null),outlined:"",label:r.label,onFocus:f[1]||(f[1]=d=>l(i).select()),"input-class":r.alignRight?"text-right":"text-left",readonly:r.readonly,"bg-color":r.bgColor},null,8,["modelValue","label","input-class","readonly","bg-color"]),r.currency!==l(t).referenceCurrency&&r.modelValue!==0?(D(),P(K,{key:0,currency:l(t).referenceCurrency,amount:l(t).convertCurrency(r.modelValue,r.currency,l(t).referenceCurrency),class:"text-caption text-left q-mt-xs"},null,8,["currency","amount"])):j("",!0)]))}},Ke={class:"q-gutter-none text-center"},Ze={key:0,class:"text-caption"},B={__name:"TwoPeopleSplitRow",props:{split:{type:Boolean,default:!1},payer:{type:Number,required:!0},youIdx:{type:Number,required:!0},otherName:{type:String,required:!0},currency:{type:String,required:!0},amount:{type:Number,required:!0}},setup(n){const e=Z(),t=n,r=I(()=>t.payer===t.youIdx),i=I(()=>t.split?(t.amount+t.amount%2)/2:t.amount),h=I(()=>t.split?r.value?"You paid, split equally":`${t.otherName} paid, split equally`:r.value?"You are owed the full amount":`${t.otherName} is owed the full amount`);return I(()=>r.value?"text-green":"text-red"),(m,g)=>(D(),M("div",Ke,[L("div",null,X(h.value),1),n.amount>0?(D(),M("div",Ze,[r.value?(D(),M(W,{key:0},[te(X(n.otherName)+" owes you ",1),a(K,{currency:n.currency,amount:i.value,"reference-currency":l(e).referenceCurrency,"converted-amount":l(e).convertCurrency(i.value,n.currency,l(e).referenceCurrency),color:"green","inline-conversion":""},null,8,["currency","amount","reference-currency","converted-amount"])],64)):(D(),M(W,{key:1},[te(" You owe "+X(n.otherName)+" ",1),a(K,{currency:n.currency,amount:i.value,"reference-currency":l(e).referenceCurrency,"converted-amount":l(e).convertCurrency(i.value,n.currency,l(e).referenceCurrency),color:"red","inline-conversion":""},null,8,["currency","amount","reference-currency","converted-amount"])],64))])):j("",!0)]))}},yt={__name:"TransactionPage",setup(n){const e=Ee(),t=Z(),r=Se(),i=R(t.getEditableTransaction()),h=R(!1),m=R(null),g=R(new Set);Fe(()=>{var s;(s=m.value)==null||s.focus()});const f=I({get:()=>t.personIdx2Id(i.value.payer)||"",set:s=>{i.value.payer=t.personId2Idx(s)}}),d=I({get:()=>{const s=i.value.debts.map((o,S)=>o.isDebtor?S:-1).filter(o=>o!==-1);return s.length===1?t.personIdx2Id(s[0]):null},set:s=>{const o=t.personId2Idx(s);i.value.debts.forEach((S,V)=>{S.isDebtor=V===o}),C()}}),u=()=>{if(d.value!==null){if(f.value===d.value)return;const s=t.personId2Idx(f.value),o=t.personId2Idx(d.value);i.value.payer=o,i.value.debts.forEach((S,V)=>{S.isDebtor=V===s}),C()}},c=t.currentSheetPeople.find(s=>s!==t.user.id),y=t.currentSheetPeople.findIndex(s=>s!==t.user.id),v=t.currentSheetPeople.findIndex(s=>s===t.user.id),F=I(()=>H.state(i.value)),w=s=>{switch(s){case 0:i.value.payer=v,i.value.debts[0].isDebtor=!0,i.value.debts[1].isDebtor=!0;break;case 1:i.value.payer=v,i.value.debts[v].isDebtor=!1,i.value.debts[y].isDebtor=!0;break;case 2:i.value.payer=y,i.value.debts[0].isDebtor=!0,i.value.debts[1].isDebtor=!0;break;case 3:i.value.payer=y,i.value.debts[v].isDebtor=!0,i.value.debts[y].isDebtor=!1;break;default:return}C()},k=s=>{g.value.add(s),p()},C=()=>{g.value.clear(),p()},p=()=>{const s=H.split(i.value,g.value);s===1&&e.notify("The amount has been increased to match the sum of the shares."),s===2&&e.notify("The amount has been decreased to match the sum of the shares.")},_=()=>{t.transactionId=null,r.go(-1)},x=async()=>{try{H.check(i.value),await t.addTransaction(i.value),t.transactionId=null,_()}catch(s){e.notify({message:s.message||s,color:"negative"});return}};return(s,o)=>(D(),M(W,null,[a(ke,{elevated:"",class:"bg-primary text-white"},{default:b(()=>[a(Ce,null,{default:b(()=>[a(O,{flat:"",icon:"arrow_back",onClick:_,"aria-label":"Go Back",class:"bg-white text-primary"}),a(we),a(O,{flat:"",icon:h.value?"visibility_off":"visibility",label:h.value?"Hide":"Show",onClick:o[0]||(o[0]=S=>h.value=!h.value),class:"q-ml-md bg-white text-primary","aria-label":"Toggle active state"},null,8,["icon","label"]),a(O,{flat:"",icon:"done",label:"Confirm",onClick:x,class:"q-ml-md bg-secondary text-white","aria-label":"Save"})]),_:1})]),_:1}),a(Re,null,{default:b(()=>[a(ie,{class:"q-my-md q-mr-md q-ml-md"},{default:b(()=>[a(A,null,{default:b(()=>[a(ue,{ref_key:"nameInput",ref:m,modelValue:i.value.name,"onUpdate:modelValue":o[1]||(o[1]=S=>i.value.name=S),label:"Transaction Name",outlined:"",onFocus:o[2]||(o[2]=S=>m.value.select())},null,8,["modelValue"])]),_:1}),a(A,{class:"row",style:{"align-items":"center"}},{default:b(()=>[a(Le,{modelValue:i.value.currency,"onUpdate:modelValue":o[3]||(o[3]=S=>i.value.currency=S),usedCurrencies:l(t).currencies,class:"q-mr-md text-subtitle1 full-height"},null,8,["modelValue","usedCurrencies"]),a(oe,{modelValue:i.value.amount,"onUpdate:modelValue":[o[4]||(o[4]=S=>i.value.amount=S),o[5]||(o[5]=S=>C())],currency:i.value.currency,style:{flex:"1"},label:"Amount"},null,8,["modelValue","currency"])]),_:1})]),_:1}),a(ie,{class:"q-my-md q-mr-md q-ml-md"},{default:b(()=>[i.value.debts.length===2?(D(),P(A,{key:0,class:"column items-center"},{default:b(()=>[a(Ne,{class:"full-width"},{label:b(()=>[a(B,{split:F.value===1,payer:i.value.payer,"you-idx":l(v),"other-name":l(t).getName(l(c)),currency:i.value.currency,amount:i.value.amount,"reference-currency":l(t).referenceCurrency},null,8,["split","payer","you-idx","other-name","currency","amount","reference-currency"])]),default:b(()=>[a(ne,null,{default:b(()=>[Q((D(),P(G,{clickable:"",class:"bg-white",onClick:o[6]||(o[6]=S=>w(0))},{default:b(()=>[a(N,null,{default:b(()=>[a(B,{split:"",payer:l(v),"you-idx":l(v),"other-name":l(t).getName(l(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[z]]),Q((D(),P(G,{clickable:"",class:"bg-grey-3",onClick:o[7]||(o[7]=S=>w(1))},{default:b(()=>[a(N,null,{default:b(()=>[a(B,{payer:l(v),"you-idx":l(v),"other-name":l(t).getName(l(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[z]]),Q((D(),P(G,{clickable:"",class:"bg-white",onClick:o[8]||(o[8]=S=>w(2))},{default:b(()=>[a(N,null,{default:b(()=>[a(B,{split:"",payer:l(y),"you-idx":l(v),"other-name":l(t).getName(l(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[z]]),Q((D(),P(G,{clickable:"",class:"bg-grey-3",onClick:o[9]||(o[9]=S=>w(3))},{default:b(()=>[a(N,null,{default:b(()=>[a(B,{payer:l(y),"you-idx":l(v),"other-name":l(t).getName(l(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[z]])]),_:1})]),_:1})]),_:1})):j("",!0),i.value.debts.length>2?(D(),P(A,{key:1,class:"row justify-center items-center no-wrap"},{default:b(()=>[a(re,{class:"col-auto q-mr-sm",modelValue:f.value,"onUpdate:modelValue":o[10]||(o[10]=S=>f.value=S),people:l(t).currentSheet.people,"sorted-people":l(t).currentSheetPeople,"fixed-label":"Payer",dense:""},null,8,["modelValue","people","sorted-people"]),a(O,{class:"col-auto q-mr-sm",icon:"swap_horiz",onClick:u}),a(re,{class:"col-auto",modelValue:d.value,"onUpdate:modelValue":o[11]||(o[11]=S=>d.value=S),people:l(t).currentSheet.people,"sorted-people":l(t).currentSheetPeople,"fixed-label":"Debtor",dense:""},null,8,["modelValue","people","sorted-people"])]),_:1})):j("",!0),a(A,{class:"row justify-center items-center"},{default:b(()=>[a(O,{flat:"",icon:"done",label:"Cancel",onClick:x,class:"q-mr-md bg-red text-white","aria-label":"Save"}),a(O,{flat:"",icon:"done",label:"Confirm",onClick:x,class:"bg-secondary text-white","aria-label":"Save"})]),_:1})]),_:1}),a(A,null,{default:b(()=>[...o[15]||(o[15]=[L("div",{class:"row text-bold items-center no-wrap"},[L("div",{style:{flex:"0 0 5%","text-align":"left"},class:"q-ml-sm q-mr-md"}," Payer "),L("div",{style:{flex:"1 0 30%","text-align":"left"}},"Person"),L("div",{style:{flex:"0 0 10%","text-align":"center"}},"Owes"),L("div",{style:{flex:"0 0 32%","text-align":"right"}},"Amount")],-1)])]),_:1}),a(ne,{class:"q-my-md q-mr-md q-ml-md"},{default:b(()=>[(D(!0),M(W,null,Ve(l(t).currentSheetPeople,(S,V)=>Q((D(),P(G,{key:V,class:De([V%2===0?"bg-grey-1":"bg-white","row no-wrap items-center"])},{default:b(()=>[a(N,{side:"",style:{flex:"0 0 5%","text-align":"left"}},{default:b(()=>[a(Ge,{modelValue:i.value.payer,"onUpdate:modelValue":[o[12]||(o[12]=$=>i.value.payer=$),o[13]||(o[13]=$=>C())],val:V,dense:""},null,8,["modelValue","val"])]),_:2},1024),a(N,{style:{flex:"1 0 50%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","text-align":"right"}},{default:b(()=>[a(Ae,{id:S},null,8,["id"])]),_:2},1024),a(N,{side:"",style:{flex:"0 0 5%","text-align":"center","margin-right":"6px"}},{default:b(()=>[a(Oe,{modelValue:i.value.debts[V].isDebtor,"onUpdate:modelValue":[$=>i.value.debts[V].isDebtor=$,o[14]||(o[14]=$=>C())],dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(N,{side:"",style:{flex:"0 0 35%"}},{default:b(()=>[a(oe,{modelValue:i.value.debts[V].owedAmount,"onUpdate:modelValue":[$=>i.value.debts[V].owedAmount=$,$=>k(V)],currency:i.value.currency,dense:"",style:{width:"auto","min-width":"4ch","border-color":"green"},readonly:!i.value.debts[V].isDebtor,"bg-color":g.value.has(V)?"green-1":""},null,8,["modelValue","onUpdate:modelValue","currency","readonly","bg-color"])]),_:2},1024)]),_:2},1032,["class"])),[[Ie,l(t).currentSheet.people[S].active||h.value||i.value.payer===V||i.value.debts[V].owedAmount!==0||i.value.debts[V].isDebtor]])),128))]),_:1})]),_:1})],64))}};export{yt as default};
