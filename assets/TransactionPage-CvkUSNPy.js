import{c as he,a2 as fe,g as se,a3 as ge,r as R,a as I,ao as J,h as E,Q as ye,s as pe,b as ve,D as ee,w as le,ap as be,K as Z,M,v as D,y as o,u as _,N as z,O as s,aq as xe,H as L,P as X,S as W,I as te,L as Se,o as Fe,Z as H,x,J as O,A as Q,T as Ve,U as De,X as Ie}from"./index-RPHRYbe4.js";import{Q as we}from"./QSpace-BzC-8nu6.js";import{Q as Ce,a as ke}from"./QHeader-DIuhQxYY.js";import{f as _e,j as $e,b as ue,Q as ie,a as A}from"./QCard-CaLyTEXD.js";import{a as ne,b as G,c as P}from"./QItemLabel-BT2yxQYC.js";import{Q as Ne,_ as re}from"./PeopleDropdown-kxXddB9Q.js";import{u as Pe,a as qe,b as Ee,Q as Re}from"./QPage-CSfZ3llX.js";import{o as Me,u as Te,Q as Oe}from"./QCheckbox-DSGCGnLB.js";import{C as U}from"./index-BYyNv4KT.js";import{_ as Ae}from"./PersonItem-Dx_g_J8e.js";import{_ as K}from"./CurrencyDisplay-D8Fdpw1L.js";import{_ as Le}from"./CurrencyDropdown-DAW-zOXn.js";import"./QResizeObserver-_X9rxPxX.js";import"./selection-CH_E7EJ3.js";import"./focusout-NvOgR3at.js";import"./scroll-DB52AouT.js";import"./utils-bRICbQdu.js";const Qe=()=>E("svg",{key:"svg",class:"q-radio__bg absolute non-selectable",viewBox:"0 0 24 24"},[E("path",{d:"M12,22a10,10 0 0 1 -10,-10a10,10 0 0 1 10,-10a10,10 0 0 1 10,10a10,10 0 0 1 -10,10m0,-22a12,12 0 0 0 -12,12a12,12 0 0 0 12,12a12,12 0 0 0 12,-12a12,12 0 0 0 -12,-12"}),E("path",{class:"q-radio__check",d:"M12,6a6,6 0 0 0 -6,6a6,6 0 0 0 6,6a6,6 0 0 0 6,-6a6,6 0 0 0 -6,-6"})]),Ge=he({name:"QRadio",props:{...Pe,...fe,..._e,modelValue:{required:!0},val:{required:!0},label:String,leftLabel:Boolean,checkedIcon:String,uncheckedIcon:String,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},emits:["update:modelValue"],setup(n,{slots:t,emit:e}){const{proxy:r}=se(),i=qe(n,r.$q),h=ge(n,Me),m=R(null),{refocusTargetEl:g,refocusTarget:f}=Te(n,m),d=I(()=>J(n.modelValue)===J(n.val)),u=I(()=>"q-radio cursor-pointer no-outline row inline no-wrap items-center"+(n.disable===!0?" disabled":"")+(i.value===!0?" q-radio--dark":"")+(n.dense===!0?" q-radio--dense":"")+(n.leftLabel===!0?" reverse":"")),c=I(()=>{const S=n.color!==void 0&&(n.keepColor===!0||d.value===!0)?` text-${n.color}`:"";return`q-radio__inner relative-position q-radio__inner--${d.value===!0?"truthy":"falsy"}${S}`}),y=I(()=>(d.value===!0?n.checkedIcon:n.uncheckedIcon)||null),b=I(()=>n.disable===!0?-1:n.tabindex||0),F=I(()=>{const S={type:"radio"};return n.name!==void 0&&Object.assign(S,{".checked":d.value===!0,"^checked":d.value===!0?"checked":void 0,name:n.name,value:n.val}),S}),w=$e(F);function k(S){S!==void 0&&(ee(S),f(S)),n.disable!==!0&&d.value!==!0&&e("update:modelValue",n.val,S)}function C(S){(S.keyCode===13||S.keyCode===32)&&ee(S)}function p(S){(S.keyCode===13||S.keyCode===32)&&k(S)}Object.assign(r,{set:k});const $=Qe();return()=>{const S=y.value!==null?[E("div",{key:"icon",class:"q-radio__icon-container absolute-full flex flex-center no-wrap"},[E(ye,{class:"q-radio__icon",name:y.value})])]:[$];n.disable!==!0&&w(S,"unshift"," q-radio__native q-ma-none q-pa-none");const l=[E("div",{class:c.value,style:h.value,"aria-hidden":"true"},S)];g.value!==null&&l.push(g.value);const a=n.label!==void 0?pe(t.default,[n.label]):ve(t.default);return a!==void 0&&l.push(E("div",{class:"q-radio__label q-anchor--skip"},a)),E("div",{ref:m,class:u.value,tabindex:b.value,role:"radio","aria-label":n.label,"aria-checked":d.value===!0?"true":"false","aria-disabled":n.disable===!0?"true":void 0,onClick:k,onKeydown:C,onKeyup:p},l)}}});var T;(function(n){n.symbol="symbol",n.narrowSymbol="narrowSymbol",n.code="code",n.name="name",n.hidden="hidden"})(T||(T={}));var q;(function(n){n.precision="precision",n.thousands="thousands",n.tenThousands="tenThousands",n.millions="millions",n.billions="billions"})(q||(q={}));const j=n=>n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ce=n=>n.replace(/^0+(0$|[^0])/,"$1"),Y=(n,t)=>(n.match(new RegExp(j(t),"g"))||[]).length,Be=(n,t)=>n.substring(0,n.indexOf(t)),me=[",",".","٫","。"],ae="(0|[1-9]\\d*)";class ze{constructor(t){var e,r,i,h,m,g;const{currency:f,currencyDisplay:d,locale:u,precision:c,accountingSign:y,useGrouping:b}=t;this.locale=u,this.options={currency:f,useGrouping:b,style:"currency",currencySign:y?"accounting":void 0,currencyDisplay:d!==T.hidden?d:void 0};const F=new Intl.NumberFormat(u,this.options),w=F.formatToParts(123456);this.currency=(e=w.find(({type:p})=>p==="currency"))===null||e===void 0?void 0:e.value,this.digits=[0,1,2,3,4,5,6,7,8,9].map(p=>p.toLocaleString(u)),this.decimalSymbol=(r=w.find(({type:p})=>p==="decimal"))===null||r===void 0?void 0:r.value,this.groupingSymbol=(i=w.find(({type:p})=>p==="group"))===null||i===void 0?void 0:i.value,this.minusSign=(h=F.formatToParts(-1).find(({type:p})=>p==="minusSign"))===null||h===void 0?void 0:h.value,this.decimalSymbol===void 0?this.minimumFractionDigits=this.maximumFractionDigits=0:typeof c=="number"?this.minimumFractionDigits=this.maximumFractionDigits=c:(this.minimumFractionDigits=(m=c==null?void 0:c.min)!==null&&m!==void 0?m:F.resolvedOptions().minimumFractionDigits,this.maximumFractionDigits=(g=c==null?void 0:c.max)!==null&&g!==void 0?g:F.resolvedOptions().maximumFractionDigits);const k=p=>Be(p,this.digits[1]),C=p=>p.substring(p.lastIndexOf(this.decimalSymbol?this.digits[0]:this.digits[1])+1);this.prefix=k(F.format(1)),this.suffix=C(F.format(1)),this.negativePrefix=k(F.format(-1)),this.negativeSuffix=C(F.format(-1))}parse(t){if(t){const e=this.isNegative(t);t=this.normalizeDigits(t),t=this.stripCurrency(t,e),t=this.stripSignLiterals(t);const r=this.decimalSymbol?`(?:${j(this.decimalSymbol)}(\\d*))?`:"",i=this.stripGroupingSeparator(t).match(new RegExp(`^${ae}${r}$`));if(i&&this.isValidIntegerFormat(this.decimalSymbol?t.split(this.decimalSymbol)[0]:t,Number(i[1])))return+`${e?"-":""}${this.onlyDigits(i[1])}.${this.onlyDigits(i[2]||"")}`}return null}isValidIntegerFormat(t,e){const r={...this.options,minimumFractionDigits:0};return[this.stripCurrency(this.normalizeDigits(e.toLocaleString(this.locale,{...r,useGrouping:!0})),!1),this.stripCurrency(this.normalizeDigits(e.toLocaleString(this.locale,{...r,useGrouping:!1})),!1)].includes(t)}format(t,e={minimumFractionDigits:this.minimumFractionDigits,maximumFractionDigits:this.maximumFractionDigits}){return t!=null?t.toLocaleString(this.locale,{...this.options,...e}):""}toFraction(t){return`${this.digits[0]}${this.decimalSymbol}${this.onlyLocaleDigits(t.substring(1)).substring(0,this.maximumFractionDigits)}`}isFractionIncomplete(t){return!!this.normalizeDigits(this.stripGroupingSeparator(t)).match(new RegExp(`^${ae}${j(this.decimalSymbol)}$`))}isNegative(t){return t.startsWith(this.negativePrefix)||this.minusSign===void 0&&(t.startsWith("(")||t.startsWith("-"))||this.minusSign!==void 0&&t.replace("-",this.minusSign).startsWith(this.minusSign)}insertCurrency(t,e){return`${e?this.negativePrefix:this.prefix}${t}${e?this.negativeSuffix:this.suffix}`}stripGroupingSeparator(t){return this.groupingSymbol!==void 0?t.replace(new RegExp(j(this.groupingSymbol),"g"),""):t}stripSignLiterals(t){return this.minusSign!==void 0?t.replace("-",this.minusSign).replace(this.minusSign,""):t.replace(/[-()]/g,"")}stripCurrency(t,e){return t.replace(e?this.negativePrefix:this.prefix,"").replace(e?this.negativeSuffix:this.suffix,"")}normalizeDecimalSeparator(t,e){return me.forEach(r=>{t=t.substring(0,e)+t.substring(e).replace(r,this.decimalSymbol)}),t}normalizeDigits(t){return this.digits[0]!=="0"&&this.digits.forEach((e,r)=>{t=t.replace(new RegExp(e,"g"),String(r))}),t}onlyDigits(t){return this.normalizeDigits(t).replace(/\D+/g,"")}onlyLocaleDigits(t){return t.replace(new RegExp(`[^${this.digits.join("")}]*`,"g"),"")}}class de{constructor(t){this.currencyFormat=t}}class Ue extends de{conformToMask(t,e=""){const r=this.currencyFormat.isNegative(t),i=F=>F===""&&r&&!(this.currencyFormat.minusSign===void 0?e===this.currencyFormat.negativePrefix+this.currencyFormat.negativeSuffix:e===this.currencyFormat.negativePrefix),h=F=>{if(i(F))return"";if(this.currencyFormat.maximumFractionDigits>0){if(this.currencyFormat.isFractionIncomplete(F))return F;if(F.startsWith(this.currencyFormat.decimalSymbol))return this.currencyFormat.toFraction(F)}return null};let m=t;m=this.currencyFormat.stripCurrency(m,r),m=this.currencyFormat.stripSignLiterals(m);const g=h(m);if(g!=null)return this.currencyFormat.insertCurrency(g,r);const[f,...d]=m.split(this.currencyFormat.decimalSymbol),u=ce(this.currencyFormat.onlyDigits(f)),c=this.currencyFormat.onlyDigits(d.join("")).substring(0,this.currencyFormat.maximumFractionDigits),y=d.length>0&&c.length===0,b=u===""&&r&&(this.currencyFormat.minusSign===void 0?e===t.slice(0,-2)+this.currencyFormat.negativeSuffix:e===t.slice(0,-1));return y||b||i(u)?e:u.match(/\d+/)?{numberValue:+`${r?"-":""}${u}.${c}`,fractionDigits:c}:""}}class je extends de{conformToMask(t,e=""){if(t===""||this.currencyFormat.parse(e)===0&&this.currencyFormat.stripCurrency(e,!0).slice(0,-1)===this.currencyFormat.stripCurrency(t,!0))return"";const r=this.currencyFormat.isNegative(t),i=this.currencyFormat.stripSignLiterals(t)===""?-0:+`${r?"-":""}${ce(this.currencyFormat.onlyDigits(t))}`/Math.pow(10,this.currencyFormat.maximumFractionDigits);return{numberValue:i,fractionDigits:i.toFixed(this.currencyFormat.maximumFractionDigits).slice(-this.currencyFormat.maximumFractionDigits)}}}const We={locale:void 0,currency:void 0,currencyDisplay:void 0,hideGroupingSeparatorOnFocus:!0,hideCurrencySymbolOnFocus:!0,hideNegligibleDecimalDigitsOnFocus:!0,precision:void 0,autoDecimalDigits:!1,valueRange:void 0,useGrouping:void 0,valueScaling:void 0};class Xe{constructor(t){this.el=t.el,this.onInput=t.onInput,this.onChange=t.onChange,this.addEventListener(),this.init(t.options)}setOptions(t){this.init(t),this.format(this.currencyFormat.format(this.validateValueRange(this.numberValue))),this.onChange(this.getValue())}getValue(){return{number:this.valueScaling&&this.numberValue!=null?this.toInteger(this.numberValue,this.valueScaling):this.numberValue,formatted:this.formattedValue}}setValue(t){const e=this.valueScaling!==void 0&&t!=null?this.toFloat(t,this.valueScaling):t;e!==this.numberValue&&(this.format(this.currencyFormat.format(this.validateValueRange(e))),this.onChange(this.getValue()))}init(t){this.options={...We,...t},this.options.autoDecimalDigits&&(this.options.hideNegligibleDecimalDigitsOnFocus=!1),this.el.getAttribute("inputmode")||this.el.setAttribute("inputmode",this.options.autoDecimalDigits?"numeric":"decimal"),this.currencyFormat=new ze(this.options),this.numberMask=this.options.autoDecimalDigits?new je(this.currencyFormat):new Ue(this.currencyFormat);const e={[q.precision]:this.currencyFormat.maximumFractionDigits,[q.thousands]:3,[q.tenThousands]:4,[q.millions]:6,[q.billions]:9};this.valueScaling=this.options.valueScaling?e[this.options.valueScaling]:void 0,this.valueScalingFractionDigits=this.valueScaling!==void 0&&this.options.valueScaling!==q.precision?this.valueScaling+this.currencyFormat.maximumFractionDigits:this.currencyFormat.maximumFractionDigits,this.minValue=this.getMinValue(),this.maxValue=this.getMaxValue()}getMinValue(){var t,e;let r=this.toFloat(-Number.MAX_SAFE_INTEGER);return((t=this.options.valueRange)===null||t===void 0?void 0:t.min)!==void 0&&(r=Math.max((e=this.options.valueRange)===null||e===void 0?void 0:e.min,this.toFloat(-Number.MAX_SAFE_INTEGER))),r}getMaxValue(){var t,e;let r=this.toFloat(Number.MAX_SAFE_INTEGER);return((t=this.options.valueRange)===null||t===void 0?void 0:t.max)!==void 0&&(r=Math.min((e=this.options.valueRange)===null||e===void 0?void 0:e.max,this.toFloat(Number.MAX_SAFE_INTEGER))),r}toFloat(t,e){return t/Math.pow(10,e!=null?e:this.valueScalingFractionDigits)}toInteger(t,e){return Number(t.toFixed(e!=null?e:this.valueScalingFractionDigits).split(".").join(""))}validateValueRange(t){return t!=null?Math.min(Math.max(t,this.minValue),this.maxValue):t}format(t,e=!1){if(t!=null){this.decimalSymbolInsertedAt!==void 0&&(t=this.currencyFormat.normalizeDecimalSeparator(t,this.decimalSymbolInsertedAt),this.decimalSymbolInsertedAt=void 0);const r=this.numberMask.conformToMask(t,this.formattedValue);let i;if(typeof r=="object"){const{numberValue:h,fractionDigits:m}=r;let{maximumFractionDigits:g,minimumFractionDigits:f}=this.currencyFormat;this.focus?f=e?m.replace(/0+$/,"").length:Math.min(g,m.length):Number.isInteger(h)&&!this.options.autoDecimalDigits&&(this.options.precision===void 0||f===0)&&(f=g=0),i=this.toInteger(Math.abs(h))>Number.MAX_SAFE_INTEGER?this.formattedValue:this.currencyFormat.format(h,{useGrouping:this.options.useGrouping!==!1&&!(this.focus&&this.options.hideGroupingSeparatorOnFocus),minimumFractionDigits:f,maximumFractionDigits:g})}else i=r;this.maxValue<=0&&!this.currencyFormat.isNegative(i)&&this.currencyFormat.parse(i)!==0&&(i=i.replace(this.currencyFormat.prefix,this.currencyFormat.negativePrefix)),this.minValue>=0&&(i=i.replace(this.currencyFormat.negativePrefix,this.currencyFormat.prefix)),(this.options.currencyDisplay===T.hidden||this.focus&&this.options.hideCurrencySymbolOnFocus)&&(i=i.replace(this.currencyFormat.negativePrefix,this.currencyFormat.minusSign!==void 0?this.currencyFormat.minusSign:"(").replace(this.currencyFormat.negativeSuffix,this.currencyFormat.minusSign!==void 0?"":")").replace(this.currencyFormat.prefix,"").replace(this.currencyFormat.suffix,"")),this.el.value=i,this.numberValue=this.currencyFormat.parse(i)}else this.el.value="",this.numberValue=null;this.formattedValue=this.el.value,this.onInput(this.getValue())}addEventListener(){this.el.addEventListener("input",t=>{const{value:e,selectionStart:r}=this.el,i=t;if(r&&i.data&&me.includes(i.data)&&(this.decimalSymbolInsertedAt=r-1),this.format(e),this.focus&&r!=null){const h=()=>{const{prefix:m,suffix:g,decimalSymbol:f,maximumFractionDigits:d,groupingSymbol:u}=this.currencyFormat;let c=e.length-r;const y=this.formattedValue.length;if(this.currencyFormat.minusSign===void 0&&(e.startsWith("(")||e.startsWith("-"))&&!e.endsWith(")"))return y-this.currencyFormat.negativeSuffix.length>1?this.formattedValue.substring(r).length:1;if(this.formattedValue.substring(r,1)===u&&Y(this.formattedValue,u)===Y(e,u)+1)return y-c-1;if(y<c)return r;if(f!==void 0&&e.indexOf(f)!==-1){const b=e.indexOf(f)+1;if(Math.abs(y-e.length)>1&&r<=b)return this.formattedValue.indexOf(f)+1;!this.options.autoDecimalDigits&&r>b&&this.currencyFormat.onlyDigits(e.substring(b)).length-1===d&&(c-=1)}return this.options.hideCurrencySymbolOnFocus||this.options.currencyDisplay===T.hidden?y-c:Math.max(y-Math.max(c,g.length),m.length)};this.setCaretPosition(h())}}),this.el.addEventListener("focus",()=>{this.focus=!0,this.numberValueOnFocus=this.numberValue,setTimeout(()=>{const{value:t,selectionStart:e,selectionEnd:r}=this.el;if(this.format(t,this.options.hideNegligibleDecimalDigitsOnFocus),e!=null&&r!=null&&Math.abs(e-r)>0)this.setCaretPosition(0,this.el.value.length);else if(e!=null){const i=this.getCaretPositionOnFocus(t,e);this.setCaretPosition(i)}})}),this.el.addEventListener("blur",()=>{this.focus=!1,this.format(this.currencyFormat.format(this.validateValueRange(this.numberValue))),this.numberValueOnFocus!==this.numberValue&&this.onChange(this.getValue())})}getCaretPositionOnFocus(t,e){if(this.numberValue==null)return e;const{prefix:r,negativePrefix:i,suffix:h,negativeSuffix:m,groupingSymbol:g,currency:f}=this.currencyFormat,d=this.numberValue<0,u=d?i:r,c=u.length;if(this.options.hideCurrencySymbolOnFocus||this.options.currencyDisplay===T.hidden){if(d){if(e<=1)return 1;if(t.endsWith(")")&&e>t.indexOf(")"))return this.formattedValue.length-1}}else{const b=d?m.length:h.length;if(e>=t.length-b)return this.formattedValue.length-b;if(e<c)return c}let y=e;return this.options.hideCurrencySymbolOnFocus&&this.options.currencyDisplay!==T.hidden&&e>=c&&f!==void 0&&u.includes(f)&&(y-=c,d&&(y+=1)),this.options.hideGroupingSeparatorOnFocus&&g!==void 0&&(y-=Y(t.substring(0,e),g)),y}setCaretPosition(t,e=t){this.el.setSelectionRange(t,e)}}const He=n=>n!=null&&n.matches("input")?n:n==null?void 0:n.querySelector("input");function Ye(n,t){var e,r,i,h;let m;const g=R(null),f=R(null),d=R(null),u=se(),c=(u==null?void 0:u.emit)||((r=(e=u==null?void 0:u.proxy)===null||e===void 0?void 0:e.$emit)===null||r===void 0?void 0:r.bind(u==null?void 0:u.proxy)),y=(u==null?void 0:u.props)||((i=u==null?void 0:u.proxy)===null||i===void 0?void 0:i.$props),b=be.startsWith("3"),F=b&&((h=u==null?void 0:u.attrs.modelModifiers)===null||h===void 0?void 0:h.lazy),w=I(()=>y==null?void 0:y[b?"modelValue":"value"]),k=b?"update:modelValue":"input",C=F?"update:modelValue":"change";return le(g,p=>{var $;if(p){const S=He(($=p==null?void 0:p.$el)!==null&&$!==void 0?$:p);S?(m=new Xe({el:S,options:n,onInput:l=>{!F&&t!==!1&&w.value!==l.number&&(c==null||c(k,l.number)),d.value=l.number,f.value=l.formatted},onChange:l=>{c==null||c(C,l.number)}}),m.setValue(w.value)):console.error('No input element found. Please make sure that the "inputRef" template ref is properly assigned.')}else m=null}),{inputRef:g,numberValue:d,formattedValue:f,setValue:p=>m==null?void 0:m.setValue(p),setOptions:p=>m==null?void 0:m.setOptions(p)}}const oe={__name:"CurrencyInput",props:{modelValue:Number,currency:String,label:String,alignRight:{type:Boolean,default:!1},bgColor:{type:String,default:""},readonly:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(n,{emit:t}){const e=Z(),r=n,{inputRef:i,formattedValue:h,setValue:m}=Ye({currency:"XXX",currencyDisplay:"hidden",valueScaling:"precision",valueRange:{min:0,max:void 0},autoSign:!0,locale:"it-CH"});return le(()=>r.modelValue,g=>{m(g)}),(g,f)=>(D(),M("div",null,[o(ue,{ref_key:"inputRef",ref:i,modelValue:s(h),"onUpdate:modelValue":f[0]||(f[0]=d=>xe(h)?h.value=d:null),outlined:"",label:r.label,onFocus:f[1]||(f[1]=d=>s(i).select()),"input-class":r.alignRight?"text-right":"text-left",readonly:r.readonly,"bg-color":r.bgColor},null,8,["modelValue","label","input-class","readonly","bg-color"]),r.currency!==s(e).referenceCurrency&&r.modelValue!==0?(D(),_(K,{key:0,currency:s(e).referenceCurrency,amount:s(e).convertCurrency(r.modelValue,r.currency,s(e).referenceCurrency),class:"text-caption text-left q-mt-xs"},null,8,["currency","amount"])):z("",!0)]))}},Ke={class:"q-gutter-none text-center"},Ze={key:0,class:"text-caption"},B={__name:"TwoPeopleSplitRow",props:{split:{type:Boolean,default:!1},payer:{type:Number,required:!0},youIdx:{type:Number,required:!0},otherName:{type:String,required:!0},currency:{type:String,required:!0},amount:{type:Number,required:!0}},setup(n){const t=Z(),e=n,r=I(()=>e.payer===e.youIdx),i=I(()=>e.split?(e.amount+e.amount%2)/2:e.amount),h=I(()=>e.split?r.value?"You paid, split equally":`${e.otherName} paid, split equally`:r.value?"You are owed the full amount":`${e.otherName} is owed the full amount`);return I(()=>r.value?"text-green":"text-red"),(m,g)=>(D(),M("div",Ke,[L("div",null,X(h.value),1),n.amount>0?(D(),M("div",Ze,[r.value?(D(),M(W,{key:0},[te(X(n.otherName)+" owes you ",1),o(K,{currency:n.currency,amount:i.value,"reference-currency":s(t).referenceCurrency,"converted-amount":s(t).convertCurrency(i.value,n.currency,s(t).referenceCurrency),color:"green","inline-conversion":""},null,8,["currency","amount","reference-currency","converted-amount"])],64)):(D(),M(W,{key:1},[te(" You owe "+X(n.otherName)+" ",1),o(K,{currency:n.currency,amount:i.value,"reference-currency":s(t).referenceCurrency,"converted-amount":s(t).convertCurrency(i.value,n.currency,s(t).referenceCurrency),color:"red","inline-conversion":""},null,8,["currency","amount","reference-currency","converted-amount"])],64))])):z("",!0)]))}},yt={__name:"TransactionPage",setup(n){const t=Ee(),e=Z(),r=Se(),i=R(e.getEditableTransaction()),h=R(!1),m=R(null),g=R(new Set);Fe(()=>{var l;(l=m.value)==null||l.focus()});const f=I({get:()=>e.personIdx2Id(i.value.payer)||"",set:l=>{i.value.payer=e.personId2Idx(l)}}),d=I({get:()=>{const l=i.value.debts.map((a,v)=>a.isDebtor?v:-1).filter(a=>a!==-1);return l.length===1?e.personIdx2Id(l[0]):null},set:l=>{const a=e.personId2Idx(l);i.value.debts.forEach((v,V)=>{v.isDebtor=V===a}),C()}}),u=()=>{if(d.value!==null){if(f.value===d.value)return;const l=e.personId2Idx(f.value),a=e.personId2Idx(d.value);i.value.payer=a,i.value.debts.forEach((v,V)=>{v.isDebtor=V===l}),C()}},c=e.currentSheetPeople.find(l=>l!==e.user.id),y=e.currentSheetPeople.findIndex(l=>l!==e.user.id),b=e.currentSheetPeople.findIndex(l=>l===e.user.id),F=I(()=>H.state(i.value)),w=l=>{switch(l){case 0:i.value.payer=b,i.value.debts[0].isDebtor=!0,i.value.debts[1].isDebtor=!0;break;case 1:i.value.payer=b,i.value.debts[b].isDebtor=!1,i.value.debts[y].isDebtor=!0;break;case 2:i.value.payer=y,i.value.debts[0].isDebtor=!0,i.value.debts[1].isDebtor=!0;break;case 3:i.value.payer=y,i.value.debts[b].isDebtor=!0,i.value.debts[y].isDebtor=!1;break;default:return}C()},k=l=>{g.value.add(l),p()},C=()=>{g.value.clear(),p()},p=()=>{const l=H.split(i.value,g.value);l===1&&t.notify("The amount has been increased to match the sum of the shares."),l===2&&t.notify("The amount has been decreased to match the sum of the shares.")},$=()=>{e.transactionId=null,r.go(-1)},S=async()=>{try{H.check(i.value),await e.addTransaction(i.value),e.transactionId=null,$()}catch(l){t.notify({message:l.message||l,color:"negative"});return}};return(l,a)=>(D(),M(W,null,[o(ke,{elevated:"",class:"bg-primary text-white"},{default:x(()=>[o(Ce,null,{default:x(()=>[o(O,{flat:"",icon:"arrow_back",onClick:$,"aria-label":"Go Back",class:"bg-white text-primary"}),o(we),s(e).currentSheetPeople.map(v=>!s(e).currentSheet.people[v].active).filter(v=>v).length?(D(),_(O,{key:0,flat:"",icon:h.value?"visibility_off":"visibility",label:h.value?"Hide":"Show",onClick:a[0]||(a[0]=v=>h.value=!h.value),class:"q-ml-md bg-white text-primary","aria-label":"Toggle active state"},null,8,["icon","label"])):z("",!0),o(O,{flat:"",icon:"done",label:"Confirm",onClick:S,class:"q-ml-md bg-secondary text-white","aria-label":"Save"})]),_:1})]),_:1}),o(Re,null,{default:x(()=>[o(ie,{class:"q-my-md q-mr-md q-ml-md"},{default:x(()=>[o(A,null,{default:x(()=>[o(ue,{ref_key:"nameInput",ref:m,modelValue:i.value.name,"onUpdate:modelValue":a[1]||(a[1]=v=>i.value.name=v),label:"Transaction Name",outlined:"",onFocus:a[2]||(a[2]=v=>m.value.select())},null,8,["modelValue"])]),_:1}),o(A,{class:"row",style:{"align-items":"center"}},{default:x(()=>[o(Le,{modelValue:i.value.currency,"onUpdate:modelValue":a[3]||(a[3]=v=>i.value.currency=v),usedCurrencies:s(e).currencies,class:"q-mr-md text-subtitle1 full-height"},null,8,["modelValue","usedCurrencies"]),o(oe,{modelValue:i.value.amount,"onUpdate:modelValue":[a[4]||(a[4]=v=>i.value.amount=v),a[5]||(a[5]=v=>C())],currency:i.value.currency,style:{flex:"1"},label:"Amount"},null,8,["modelValue","currency"])]),_:1})]),_:1}),o(ie,{class:"q-my-md q-mr-md q-ml-md"},{default:x(()=>[i.value.debts.length===2?(D(),_(A,{key:0,class:"column items-center"},{default:x(()=>[o(Ne,{class:"full-width"},{label:x(()=>[o(B,{split:F.value===1,payer:i.value.payer,"you-idx":s(b),"other-name":s(e).getName(s(c)),currency:i.value.currency,amount:i.value.amount,"reference-currency":s(e).referenceCurrency},null,8,["split","payer","you-idx","other-name","currency","amount","reference-currency"])]),default:x(()=>[o(ne,null,{default:x(()=>[Q((D(),_(G,{clickable:"",class:"bg-white",onClick:a[6]||(a[6]=v=>w(0))},{default:x(()=>[o(P,null,{default:x(()=>[o(B,{split:"",payer:s(b),"you-idx":s(b),"other-name":s(e).getName(s(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[U]]),Q((D(),_(G,{clickable:"",class:"bg-grey-3",onClick:a[7]||(a[7]=v=>w(1))},{default:x(()=>[o(P,null,{default:x(()=>[o(B,{payer:s(b),"you-idx":s(b),"other-name":s(e).getName(s(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[U]]),Q((D(),_(G,{clickable:"",class:"bg-white",onClick:a[8]||(a[8]=v=>w(2))},{default:x(()=>[o(P,null,{default:x(()=>[o(B,{split:"",payer:s(y),"you-idx":s(b),"other-name":s(e).getName(s(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[U]]),Q((D(),_(G,{clickable:"",class:"bg-grey-3",onClick:a[9]||(a[9]=v=>w(3))},{default:x(()=>[o(P,null,{default:x(()=>[o(B,{payer:s(y),"you-idx":s(b),"other-name":s(e).getName(s(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[U]])]),_:1})]),_:1})]),_:1})):z("",!0),i.value.debts.length>2?(D(),_(A,{key:1,class:"row justify-center items-center no-wrap"},{default:x(()=>[o(re,{class:"col-auto q-mr-sm",modelValue:f.value,"onUpdate:modelValue":a[10]||(a[10]=v=>f.value=v),people:s(e).currentSheet.people,"sorted-people":s(e).currentSheetPeople,"fixed-label":"Payer",dense:""},null,8,["modelValue","people","sorted-people"]),o(O,{class:"col-auto q-mr-sm",icon:"swap_horiz",onClick:u}),o(re,{class:"col-auto",modelValue:d.value,"onUpdate:modelValue":a[11]||(a[11]=v=>d.value=v),people:s(e).currentSheet.people,"sorted-people":s(e).currentSheetPeople,"fixed-label":"Debtor",dense:""},null,8,["modelValue","people","sorted-people"])]),_:1})):z("",!0),o(A,{class:"row justify-center items-center"},{default:x(()=>[o(O,{flat:"",icon:"done",label:"Cancel",onClick:S,class:"q-mr-md bg-red text-white","aria-label":"Save"}),o(O,{flat:"",icon:"done",label:"Confirm",onClick:S,class:"bg-secondary text-white","aria-label":"Save"})]),_:1})]),_:1}),o(A,null,{default:x(()=>[...a[15]||(a[15]=[L("div",{class:"row text-bold items-center no-wrap"},[L("div",{style:{flex:"0 0 5%","text-align":"left"},class:"q-ml-sm q-mr-md"}," Payer "),L("div",{style:{flex:"1 0 30%","text-align":"left"}},"Person"),L("div",{style:{flex:"0 0 10%","text-align":"center"}},"Owes"),L("div",{style:{flex:"0 0 32%","text-align":"right"}},"Amount")],-1)])]),_:1}),o(ne,{class:"q-my-md q-mr-md q-ml-md"},{default:x(()=>[(D(!0),M(W,null,Ve(s(e).currentSheetPeople,(v,V)=>Q((D(),_(G,{key:V,class:De([V%2===0?"bg-grey-1":"bg-white","row no-wrap items-center"])},{default:x(()=>[o(P,{side:"",style:{flex:"0 0 5%","text-align":"left"}},{default:x(()=>[o(Ge,{modelValue:i.value.payer,"onUpdate:modelValue":[a[12]||(a[12]=N=>i.value.payer=N),a[13]||(a[13]=N=>C())],val:V,dense:""},null,8,["modelValue","val"])]),_:2},1024),o(P,{style:{flex:"1 0 50%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","text-align":"right"}},{default:x(()=>[o(Ae,{id:v},null,8,["id"])]),_:2},1024),o(P,{side:"",style:{flex:"0 0 5%","text-align":"center","margin-right":"6px"}},{default:x(()=>[o(Oe,{modelValue:i.value.debts[V].isDebtor,"onUpdate:modelValue":[N=>i.value.debts[V].isDebtor=N,a[14]||(a[14]=N=>C())],dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(P,{side:"",style:{flex:"0 0 35%"}},{default:x(()=>[o(oe,{modelValue:i.value.debts[V].owedAmount,"onUpdate:modelValue":[N=>i.value.debts[V].owedAmount=N,N=>k(V)],currency:i.value.currency,dense:"",style:{width:"auto","min-width":"4ch","border-color":"green"},readonly:!i.value.debts[V].isDebtor,"bg-color":g.value.has(V)?"green-1":""},null,8,["modelValue","onUpdate:modelValue","currency","readonly","bg-color"])]),_:2},1024)]),_:2},1032,["class"])),[[Ie,s(e).currentSheet.people[v].active||h.value||i.value.payer===V||i.value.debts[V].owedAmount!==0||i.value.debts[V].isDebtor]])),128))]),_:1})]),_:1})],64))}};export{yt as default};
