import{c as de,aH as he,aI as fe,r as E,a as D,h as P,Q as ge,s as ye,b as pe,g as se,E as Z,aQ as J,w as le,aR as ve,O as K,u as V,P as R,y as l,U as u,aS as be,v as N,V as j,L as T,W as X,S as W,M as ee,o as xe,x,T as Fe,N as M,C as L,X as Se,aD as Q,Y as Ve,ak as De}from"./index.59b76f8e.js";import{Q as Ie}from"./QSpace.ee125141.js";import{Q as we,a as Ce}from"./QHeader.3e9f20f2.js";import{j as ke,n as _e,b as oe,a as te,Q as A}from"./QCard.108a60f0.js";import{a as ie,c as G,b as $}from"./QItemLabel.20f21824.js";import{Q as $e,_ as ne}from"./PeopleDropdown.ec41fdc6.js";import{u as Ne,a as Pe,Q as Ee,b as qe}from"./QPage.d4c5a6b8.js";import{o as Re,u as Oe,Q as Me}from"./QCheckbox.29f2864e.js";import{C as z}from"./index.5dd77249.js";import{_ as Ae}from"./PersonItem.d6f13c24.js";import{_ as H}from"./CurrencyDisplay.b838cd9d.js";import{_ as Te}from"./CurrencyDropdown.84021f40.js";import"./QResizeObserver.28f90742.js";import"./selection.ce1c01f4.js";import"./focusout.8d352daf.js";import"./scroll.f1c5cfbf.js";import"./utils.9ecf9ee0.js";const Le=()=>P("svg",{key:"svg",class:"q-radio__bg absolute non-selectable",viewBox:"0 0 24 24"},[P("path",{d:"M12,22a10,10 0 0 1 -10,-10a10,10 0 0 1 10,-10a10,10 0 0 1 10,10a10,10 0 0 1 -10,10m0,-22a12,12 0 0 0 -12,12a12,12 0 0 0 12,12a12,12 0 0 0 12,-12a12,12 0 0 0 -12,-12"}),P("path",{class:"q-radio__check",d:"M12,6a6,6 0 0 0 -6,6a6,6 0 0 0 6,6a6,6 0 0 0 6,-6a6,6 0 0 0 -6,-6"})]);var Qe=de({name:"QRadio",props:{...Ne,...he,...ke,modelValue:{required:!0},val:{required:!0},label:String,leftLabel:Boolean,checkedIcon:String,uncheckedIcon:String,color:String,keepColor:Boolean,dense:Boolean,disable:Boolean,tabindex:[String,Number]},emits:["update:modelValue"],setup(n,{slots:e,emit:t}){const{proxy:r}=se(),i=Pe(n,r.$q),h=fe(n,Re),m=E(null),{refocusTargetEl:p,refocusTarget:f}=Oe(n,m),d=D(()=>J(n.modelValue)===J(n.val)),o=D(()=>"q-radio cursor-pointer no-outline row inline no-wrap items-center"+(n.disable===!0?" disabled":"")+(i.value===!0?" q-radio--dark":"")+(n.dense===!0?" q-radio--dense":"")+(n.leftLabel===!0?" reverse":"")),c=D(()=>{const a=n.color!==void 0&&(n.keepColor===!0||d.value===!0)?` text-${n.color}`:"";return`q-radio__inner relative-position q-radio__inner--${d.value===!0?"truthy":"falsy"}${a}`}),g=D(()=>(d.value===!0?n.checkedIcon:n.uncheckedIcon)||null),v=D(()=>n.disable===!0?-1:n.tabindex||0),F=D(()=>{const a={type:"radio"};return n.name!==void 0&&Object.assign(a,{".checked":d.value===!0,"^checked":d.value===!0?"checked":void 0,name:n.name,value:n.val}),a}),I=_e(F);function C(a){a!==void 0&&(Z(a),f(a)),n.disable!==!0&&d.value!==!0&&t("update:modelValue",n.val,a)}function w(a){(a.keyCode===13||a.keyCode===32)&&Z(a)}function y(a){(a.keyCode===13||a.keyCode===32)&&C(a)}Object.assign(r,{set:C});const k=Le();return()=>{const a=g.value!==null?[P("div",{key:"icon",class:"q-radio__icon-container absolute-full flex flex-center no-wrap"},[P(ge,{class:"q-radio__icon",name:g.value})])]:[k];n.disable!==!0&&I(a,"unshift"," q-radio__native q-ma-none q-pa-none");const s=[P("div",{class:c.value,style:h.value,"aria-hidden":"true"},a)];p.value!==null&&s.push(p.value);const b=n.label!==void 0?ye(e.default,[n.label]):pe(e.default);return b!==void 0&&s.push(P("div",{class:"q-radio__label q-anchor--skip"},b)),P("div",{ref:m,class:o.value,tabindex:v.value,role:"radio","aria-label":n.label,"aria-checked":d.value===!0?"true":"false","aria-disabled":n.disable===!0?"true":void 0,onClick:C,onKeydown:w,onKeyup:y},s)}}});/**
 * Vue Currency Input 3.1.0
 * (c) 2018-2024 Matthias Stiller
 * @license MIT
 */var O;(function(n){n.symbol="symbol",n.narrowSymbol="narrowSymbol",n.code="code",n.name="name",n.hidden="hidden"})(O||(O={}));var q;(function(n){n.precision="precision",n.thousands="thousands",n.millions="millions",n.billions="billions"})(q||(q={}));const U=n=>n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),ue=n=>n.replace(/^0+(0$|[^0])/,"$1"),Y=(n,e)=>(n.match(new RegExp(U(e),"g"))||[]).length,Ge=(n,e)=>n.substring(0,n.indexOf(e)),ce=[",",".","\u066B","\u3002"],re="(0|[1-9]\\d*)";class Be{constructor(e){var t,r,i,h,m,p;const{currency:f,currencyDisplay:d,locale:o,precision:c,accountingSign:g,useGrouping:v}=e;this.locale=o,this.options={currency:f,useGrouping:v,style:"currency",currencySign:g?"accounting":void 0,currencyDisplay:d!==O.hidden?d:void 0};const F=new Intl.NumberFormat(o,this.options),I=F.formatToParts(123456);this.currency=(t=I.find(({type:y})=>y==="currency"))===null||t===void 0?void 0:t.value,this.digits=[0,1,2,3,4,5,6,7,8,9].map(y=>y.toLocaleString(o)),this.decimalSymbol=(r=I.find(({type:y})=>y==="decimal"))===null||r===void 0?void 0:r.value,this.groupingSymbol=(i=I.find(({type:y})=>y==="group"))===null||i===void 0?void 0:i.value,this.minusSign=(h=F.formatToParts(-1).find(({type:y})=>y==="minusSign"))===null||h===void 0?void 0:h.value,this.decimalSymbol===void 0?this.minimumFractionDigits=this.maximumFractionDigits=0:typeof c=="number"?this.minimumFractionDigits=this.maximumFractionDigits=c:(this.minimumFractionDigits=(m=c==null?void 0:c.min)!==null&&m!==void 0?m:F.resolvedOptions().minimumFractionDigits,this.maximumFractionDigits=(p=c==null?void 0:c.max)!==null&&p!==void 0?p:F.resolvedOptions().maximumFractionDigits);const C=y=>Ge(y,this.digits[1]),w=y=>y.substring(y.lastIndexOf(this.decimalSymbol?this.digits[0]:this.digits[1])+1);this.prefix=C(F.format(1)),this.suffix=w(F.format(1)),this.negativePrefix=C(F.format(-1)),this.negativeSuffix=w(F.format(-1))}parse(e){if(e){const t=this.isNegative(e);e=this.normalizeDigits(e),e=this.stripCurrency(e,t),e=this.stripSignLiterals(e);const r=this.decimalSymbol?`(?:${U(this.decimalSymbol)}(\\d*))?`:"",i=this.stripGroupingSeparator(e).match(new RegExp(`^${re}${r}$`));if(i&&this.isValidIntegerFormat(this.decimalSymbol?e.split(this.decimalSymbol)[0]:e,Number(i[1])))return Number(`${t?"-":""}${this.onlyDigits(i[1])}.${this.onlyDigits(i[2]||"")}`)}return null}isValidIntegerFormat(e,t){const r={...this.options,minimumFractionDigits:0};return[this.stripCurrency(this.normalizeDigits(t.toLocaleString(this.locale,{...r,useGrouping:!0})),!1),this.stripCurrency(this.normalizeDigits(t.toLocaleString(this.locale,{...r,useGrouping:!1})),!1)].includes(e)}format(e,t={minimumFractionDigits:this.minimumFractionDigits,maximumFractionDigits:this.maximumFractionDigits}){return e!=null?e.toLocaleString(this.locale,{...this.options,...t}):""}toFraction(e){return`${this.digits[0]}${this.decimalSymbol}${this.onlyLocaleDigits(e.substring(1)).substring(0,this.maximumFractionDigits)}`}isFractionIncomplete(e){return!!this.normalizeDigits(this.stripGroupingSeparator(e)).match(new RegExp(`^${re}${U(this.decimalSymbol)}$`))}isNegative(e){return e.startsWith(this.negativePrefix)||this.minusSign===void 0&&(e.startsWith("(")||e.startsWith("-"))||this.minusSign!==void 0&&e.replace("-",this.minusSign).startsWith(this.minusSign)}insertCurrency(e,t){return`${t?this.negativePrefix:this.prefix}${e}${t?this.negativeSuffix:this.suffix}`}stripGroupingSeparator(e){return this.groupingSymbol!==void 0?e.replace(new RegExp(U(this.groupingSymbol),"g"),""):e}stripSignLiterals(e){return this.minusSign!==void 0?e.replace("-",this.minusSign).replace(this.minusSign,""):e.replace(/[-()]/g,"")}stripCurrency(e,t){return e.replace(t?this.negativePrefix:this.prefix,"").replace(t?this.negativeSuffix:this.suffix,"")}normalizeDecimalSeparator(e,t){return ce.forEach(r=>{e=e.substring(0,t)+e.substring(t).replace(r,this.decimalSymbol)}),e}normalizeDigits(e){return this.digits[0]!=="0"&&this.digits.forEach((t,r)=>{e=e.replace(new RegExp(t,"g"),String(r))}),e}onlyDigits(e){return this.normalizeDigits(e).replace(/\D+/g,"")}onlyLocaleDigits(e){return e.replace(new RegExp(`[^${this.digits.join("")}]*`,"g"),"")}}class me{constructor(e){this.currencyFormat=e}}class ze extends me{conformToMask(e,t=""){const r=this.currencyFormat.isNegative(e),i=F=>F===""&&r&&!(this.currencyFormat.minusSign===void 0?t===this.currencyFormat.negativePrefix+this.currencyFormat.negativeSuffix:t===this.currencyFormat.negativePrefix),h=F=>{if(i(F))return"";if(this.currencyFormat.maximumFractionDigits>0){if(this.currencyFormat.isFractionIncomplete(F))return F;if(F.startsWith(this.currencyFormat.decimalSymbol))return this.currencyFormat.toFraction(F)}return null};let m=e;m=this.currencyFormat.stripCurrency(m,r),m=this.currencyFormat.stripSignLiterals(m);const p=h(m);if(p!=null)return this.currencyFormat.insertCurrency(p,r);const[f,...d]=m.split(this.currencyFormat.decimalSymbol),o=ue(this.currencyFormat.onlyDigits(f)),c=this.currencyFormat.onlyDigits(d.join("")).substring(0,this.currencyFormat.maximumFractionDigits),g=d.length>0&&c.length===0,v=o===""&&r&&(this.currencyFormat.minusSign===void 0?t===e.slice(0,-2)+this.currencyFormat.negativeSuffix:t===e.slice(0,-1));return g||v||i(o)?t:o.match(/\d+/)?{numberValue:Number(`${r?"-":""}${o}.${c}`),fractionDigits:c}:""}}class Ue extends me{conformToMask(e,t=""){if(e===""||this.currencyFormat.parse(t)===0&&this.currencyFormat.stripCurrency(t,!0).slice(0,-1)===this.currencyFormat.stripCurrency(e,!0))return"";const r=this.currencyFormat.isNegative(e),i=this.currencyFormat.stripSignLiterals(e)===""?-0:Number(`${r?"-":""}${ue(this.currencyFormat.onlyDigits(e))}`)/Math.pow(10,this.currencyFormat.maximumFractionDigits);return{numberValue:i,fractionDigits:i.toFixed(this.currencyFormat.maximumFractionDigits).slice(-this.currencyFormat.maximumFractionDigits)}}}const je={locale:void 0,currency:void 0,currencyDisplay:void 0,hideGroupingSeparatorOnFocus:!0,hideCurrencySymbolOnFocus:!0,hideNegligibleDecimalDigitsOnFocus:!0,precision:void 0,autoDecimalDigits:!1,valueRange:void 0,useGrouping:void 0,valueScaling:void 0};class We{constructor(e){this.el=e.el,this.onInput=e.onInput,this.onChange=e.onChange,this.addEventListener(),this.init(e.options)}setOptions(e){this.init(e),this.format(this.currencyFormat.format(this.validateValueRange(this.numberValue))),this.onChange(this.getValue())}getValue(){return{number:this.valueScaling&&this.numberValue!=null?this.toInteger(this.numberValue,this.valueScaling):this.numberValue,formatted:this.formattedValue}}setValue(e){const t=this.valueScaling!==void 0&&e!=null?this.toFloat(e,this.valueScaling):e;t!==this.numberValue&&(this.format(this.currencyFormat.format(this.validateValueRange(t))),this.onChange(this.getValue()))}init(e){this.options={...je,...e},this.options.autoDecimalDigits&&(this.options.hideNegligibleDecimalDigitsOnFocus=!1),this.el.getAttribute("inputmode")||this.el.setAttribute("inputmode",this.options.autoDecimalDigits?"numeric":"decimal"),this.currencyFormat=new Be(this.options),this.numberMask=this.options.autoDecimalDigits?new Ue(this.currencyFormat):new ze(this.currencyFormat);const t={[q.precision]:this.currencyFormat.maximumFractionDigits,[q.thousands]:3,[q.millions]:6,[q.billions]:9};this.valueScaling=this.options.valueScaling?t[this.options.valueScaling]:void 0,this.valueScalingFractionDigits=this.valueScaling!==void 0&&this.options.valueScaling!==q.precision?this.valueScaling+this.currencyFormat.maximumFractionDigits:this.currencyFormat.maximumFractionDigits,this.minValue=this.getMinValue(),this.maxValue=this.getMaxValue()}getMinValue(){var e,t;let r=this.toFloat(-Number.MAX_SAFE_INTEGER);return((e=this.options.valueRange)===null||e===void 0?void 0:e.min)!==void 0&&(r=Math.max((t=this.options.valueRange)===null||t===void 0?void 0:t.min,this.toFloat(-Number.MAX_SAFE_INTEGER))),r}getMaxValue(){var e,t;let r=this.toFloat(Number.MAX_SAFE_INTEGER);return((e=this.options.valueRange)===null||e===void 0?void 0:e.max)!==void 0&&(r=Math.min((t=this.options.valueRange)===null||t===void 0?void 0:t.max,this.toFloat(Number.MAX_SAFE_INTEGER))),r}toFloat(e,t){return e/Math.pow(10,t!=null?t:this.valueScalingFractionDigits)}toInteger(e,t){return Number(e.toFixed(t!=null?t:this.valueScalingFractionDigits).split(".").join(""))}validateValueRange(e){return e!=null?Math.min(Math.max(e,this.minValue),this.maxValue):e}format(e,t=!1){if(e!=null){this.decimalSymbolInsertedAt!==void 0&&(e=this.currencyFormat.normalizeDecimalSeparator(e,this.decimalSymbolInsertedAt),this.decimalSymbolInsertedAt=void 0);const r=this.numberMask.conformToMask(e,this.formattedValue);let i;if(typeof r=="object"){const{numberValue:h,fractionDigits:m}=r;let{maximumFractionDigits:p,minimumFractionDigits:f}=this.currencyFormat;this.focus?f=t?m.replace(/0+$/,"").length:Math.min(p,m.length):Number.isInteger(h)&&!this.options.autoDecimalDigits&&(this.options.precision===void 0||f===0)&&(f=p=0),i=this.toInteger(Math.abs(h))>Number.MAX_SAFE_INTEGER?this.formattedValue:this.currencyFormat.format(h,{useGrouping:this.options.useGrouping!==!1&&!(this.focus&&this.options.hideGroupingSeparatorOnFocus),minimumFractionDigits:f,maximumFractionDigits:p})}else i=r;this.maxValue<=0&&!this.currencyFormat.isNegative(i)&&this.currencyFormat.parse(i)!==0&&(i=i.replace(this.currencyFormat.prefix,this.currencyFormat.negativePrefix)),this.minValue>=0&&(i=i.replace(this.currencyFormat.negativePrefix,this.currencyFormat.prefix)),(this.options.currencyDisplay===O.hidden||this.focus&&this.options.hideCurrencySymbolOnFocus)&&(i=i.replace(this.currencyFormat.negativePrefix,this.currencyFormat.minusSign!==void 0?this.currencyFormat.minusSign:"(").replace(this.currencyFormat.negativeSuffix,this.currencyFormat.minusSign!==void 0?"":")").replace(this.currencyFormat.prefix,"").replace(this.currencyFormat.suffix,"")),this.el.value=i,this.numberValue=this.currencyFormat.parse(i)}else this.el.value="",this.numberValue=null;this.formattedValue=this.el.value,this.onInput(this.getValue())}addEventListener(){this.el.addEventListener("input",e=>{const{value:t,selectionStart:r}=this.el,i=e;if(r&&i.data&&ce.includes(i.data)&&(this.decimalSymbolInsertedAt=r-1),this.format(t),this.focus&&r!=null){const h=()=>{const{prefix:m,suffix:p,decimalSymbol:f,maximumFractionDigits:d,groupingSymbol:o}=this.currencyFormat;let c=t.length-r;const g=this.formattedValue.length;if(this.currencyFormat.minusSign===void 0&&(t.startsWith("(")||t.startsWith("-"))&&!t.endsWith(")"))return g-this.currencyFormat.negativeSuffix.length>1?this.formattedValue.substring(r).length:1;if(this.formattedValue.substring(r,1)===o&&Y(this.formattedValue,o)===Y(t,o)+1)return g-c-1;if(g<c)return r;if(f!==void 0&&t.indexOf(f)!==-1){const v=t.indexOf(f)+1;if(Math.abs(g-t.length)>1&&r<=v)return this.formattedValue.indexOf(f)+1;!this.options.autoDecimalDigits&&r>v&&this.currencyFormat.onlyDigits(t.substring(v)).length-1===d&&(c-=1)}return this.options.hideCurrencySymbolOnFocus||this.options.currencyDisplay===O.hidden?g-c:Math.max(g-Math.max(c,p.length),m.length)};this.setCaretPosition(h())}}),this.el.addEventListener("focus",()=>{this.focus=!0,this.numberValueOnFocus=this.numberValue,setTimeout(()=>{const{value:e,selectionStart:t,selectionEnd:r}=this.el;if(this.format(e,this.options.hideNegligibleDecimalDigitsOnFocus),t!=null&&r!=null&&Math.abs(t-r)>0)this.setCaretPosition(0,this.el.value.length);else if(t!=null){const i=this.getCaretPositionOnFocus(e,t);this.setCaretPosition(i)}})}),this.el.addEventListener("blur",()=>{this.focus=!1,this.format(this.currencyFormat.format(this.validateValueRange(this.numberValue))),this.numberValueOnFocus!==this.numberValue&&this.onChange(this.getValue())})}getCaretPositionOnFocus(e,t){if(this.numberValue==null)return t;const{prefix:r,negativePrefix:i,suffix:h,negativeSuffix:m,groupingSymbol:p,currency:f}=this.currencyFormat,d=this.numberValue<0,o=d?i:r,c=o.length;if(this.options.hideCurrencySymbolOnFocus||this.options.currencyDisplay===O.hidden){if(d){if(t<=1)return 1;if(e.endsWith(")")&&t>e.indexOf(")"))return this.formattedValue.length-1}}else{const v=d?m.length:h.length;if(t>=e.length-v)return this.formattedValue.length-v;if(t<c)return c}let g=t;return this.options.hideCurrencySymbolOnFocus&&this.options.currencyDisplay!==O.hidden&&t>=c&&f!==void 0&&o.includes(f)&&(g-=c,d&&(g+=1)),this.options.hideGroupingSeparatorOnFocus&&p!==void 0&&(g-=Y(e.substring(0,t),p)),g}setCaretPosition(e,t=e){this.el.setSelectionRange(e,t)}}const Xe=n=>n!=null&&n.matches("input")?n:n==null?void 0:n.querySelector("input");function Ye(n,e){var t,r,i,h;let m;const p=E(null),f=E(null),d=E(null),o=se(),c=(o==null?void 0:o.emit)||((r=(t=o==null?void 0:o.proxy)===null||t===void 0?void 0:t.$emit)===null||r===void 0?void 0:r.bind(o==null?void 0:o.proxy)),g=(o==null?void 0:o.props)||((i=o==null?void 0:o.proxy)===null||i===void 0?void 0:i.$props),v=ve.startsWith("3"),F=v&&((h=o==null?void 0:o.attrs.modelModifiers)===null||h===void 0?void 0:h.lazy),I=D(()=>g==null?void 0:g[v?"modelValue":"value"]),C=v?"update:modelValue":"input",w=F?"update:modelValue":"change";return le(p,y=>{var k;if(y){const a=Xe((k=y==null?void 0:y.$el)!==null&&k!==void 0?k:y);a?(m=new We({el:a,options:n,onInput:s=>{!F&&e!==!1&&I.value!==s.number&&(c==null||c(C,s.number)),d.value=s.number,f.value=s.formatted},onChange:s=>{e!==!1&&(c==null||c(w,s.number))}}),m.setValue(I.value)):console.error('No input element found. Please make sure that the "inputRef" template ref is properly assigned.')}else m=null}),{inputRef:p,numberValue:d,formattedValue:f,setValue:y=>m==null?void 0:m.setValue(y),setOptions:y=>m==null?void 0:m.setOptions(y)}}const ae={__name:"CurrencyInput",props:{modelValue:Number,currency:String,label:String,alignRight:{type:Boolean,default:!1}},emits:["change","update:modelValue"],setup(n,{emit:e}){const t=K(),r=n,{inputRef:i,formattedValue:h,setValue:m,setOptions:p}=Ye({currency:"XXX",currencyDisplay:"hidden",valueScaling:"precision",valueRange:{min:0,max:void 0},autoSign:!0,locale:"it-CH"});return le(()=>r.modelValue,f=>{m(f)}),(f,d)=>(V(),R("div",null,[l(oe,{ref_key:"inputRef",ref:i,modelValue:u(h),"onUpdate:modelValue":d[0]||(d[0]=o=>be(h)?h.value=o:null),outlined:"",label:r.label,onFocus:d[1]||(d[1]=o=>u(i).select()),"input-class":r.alignRight?"text-right":"text-left"},null,8,["modelValue","label","input-class"]),r.currency!==u(t).referenceCurrency&&r.modelValue!==0?(V(),N(H,{key:0,currency:u(t).referenceCurrency,amount:u(t).convertCurrency(r.modelValue,r.currency,u(t).referenceCurrency),class:"text-caption text-left q-mt-xs"},null,8,["currency","amount"])):j("",!0)]))}},He={class:"q-gutter-none text-center"},Ke={key:0,class:"text-caption"},B={__name:"TwoPeopleSplitRow",props:{split:{type:Boolean,default:!1},payer:{type:Number,required:!0},youIdx:{type:Number,required:!0},otherName:{type:String,required:!0},currency:{type:String,required:!0},amount:{type:Number,required:!0}},setup(n){const e=K(),t=n,r=D(()=>t.payer===t.youIdx),i=D(()=>t.split?(t.amount+t.amount%2)/2:t.amount),h=D(()=>t.split?r.value?"You paid, split equally":`${t.otherName} paid, split equally`:r.value?"You are owed the full amount":`${t.otherName} is owed the full amount`);return D(()=>r.value?"text-green":"text-red"),(m,p)=>(V(),R("div",He,[T("div",null,X(h.value),1),n.amount>0?(V(),R("div",Ke,[r.value?(V(),R(W,{key:0},[ee(X(n.otherName)+" owes you ",1),l(H,{currency:n.currency,amount:i.value,"reference-currency":u(e).referenceCurrency,"converted-amount":u(e).convertCurrency(i.value,n.currency,u(e).referenceCurrency),color:"green","inline-conversion":""},null,8,["currency","amount","reference-currency","converted-amount"])],64)):(V(),R(W,{key:1},[ee(" You owe "+X(n.otherName)+" ",1),l(H,{currency:n.currency,amount:i.value,"reference-currency":u(e).referenceCurrency,"converted-amount":u(e).convertCurrency(i.value,n.currency,u(e).referenceCurrency),color:"red","inline-conversion":""},null,8,["currency","amount","reference-currency","converted-amount"])],64))])):j("",!0)]))}},gt={__name:"TransactionPage",setup(n){const e=qe(),t=K(),r=Fe(),i=E(t.getEditableTransaction()),h=E(!1),m=E(null),p=E(!1);xe(()=>{var a;(a=m.value)==null||a.focus()});const f=D({get:()=>t.personIdx2Id(i.value.payer)||"",set:a=>{i.value.payer=t.personId2Idx(a)}}),d=D({get:()=>{const a=i.value.debts.map((s,b)=>s.isDebtor?b:-1).filter(s=>s!==-1);return a.length===1?t.personIdx2Id(a[0]):null},set:a=>{const s=t.personId2Idx(a);i.value.debts.forEach((b,S)=>{b.isDebtor=S===s}),w(!1)}}),o=()=>{if(d.value!==null){if(f.value===d.value)return;const a=t.personId2Idx(f.value),s=t.personId2Idx(d.value);i.value.payer=s,i.value.debts.forEach((b,S)=>{b.isDebtor=S===a}),w(!1)}},c=t.currentSheetPeople.find(a=>a!==t.user.id),g=t.currentSheetPeople.findIndex(a=>a!==t.user.id),v=t.currentSheetPeople.findIndex(a=>a===t.user.id),F=D(()=>Q.state(i.value)),I=a=>{switch(a){case 0:i.value.payer=v,i.value.debts[0].isDebtor=!0,i.value.debts[1].isDebtor=!0;break;case 1:i.value.payer=v,i.value.debts[v].isDebtor=!1,i.value.debts[g].isDebtor=!0;break;case 2:i.value.payer=g,i.value.debts[0].isDebtor=!0,i.value.debts[1].isDebtor=!0;break;case 3:i.value.payer=g,i.value.debts[v].isDebtor=!0,i.value.debts[g].isDebtor=!1;break;default:return}w(!0)},C=a=>{p.value||(p.value=!0,Q.clearOwedAmounts(i.value,a)),Q.fillLastOwedAmount(i.value)&&e.notify("The amount has been increased to match the sum of the shares.")},w=a=>{(a||!p.value)&&(p.value=!1,Q.split(i.value))},y=()=>{t.transactionId=null,r.go(-1)},k=async()=>{try{Q.check(i.value),await t.addTransaction(i.value),t.transactionId=null,y()}catch(a){e.notify({message:a.message||a,color:"negative"});return}};return(a,s)=>(V(),R(W,null,[l(we,{elevated:"",class:"bg-primary text-white"},{default:x(()=>[l(Ce,null,{default:x(()=>[l(M,{flat:"",icon:"arrow_back",onClick:y,"aria-label":"Go Back",class:"bg-white text-primary"}),l(Ie),l(M,{flat:"",icon:h.value?"visibility_off":"visibility",label:h.value?"Hide":"Show",onClick:s[0]||(s[0]=b=>h.value=!h.value),class:"q-ml-md bg-white text-primary","aria-label":"Toggle active state"},null,8,["icon","label"]),l(M,{flat:"",icon:"done",label:"Confirm",onClick:k,class:"q-ml-md bg-secondary text-white","aria-label":"Save"})]),_:1})]),_:1}),l(Ee,null,{default:x(()=>[l(te,{class:"q-my-md q-mr-md q-ml-md"},{default:x(()=>[l(A,null,{default:x(()=>[l(oe,{ref_key:"nameInput",ref:m,modelValue:i.value.name,"onUpdate:modelValue":s[1]||(s[1]=b=>i.value.name=b),label:"Transaction Name",outlined:"",onFocus:s[2]||(s[2]=b=>m.value.select())},null,8,["modelValue"])]),_:1}),l(A,{class:"row",style:{"align-items":"center"}},{default:x(()=>[l(Te,{modelValue:i.value.currency,"onUpdate:modelValue":s[3]||(s[3]=b=>i.value.currency=b),usedCurrencies:u(t).currencies,class:"q-mr-md text-subtitle1 full-height"},null,8,["modelValue","usedCurrencies"]),l(ae,{modelValue:i.value.amount,"onUpdate:modelValue":[s[4]||(s[4]=b=>i.value.amount=b),s[5]||(s[5]=b=>w(!0))],currency:i.value.currency,style:{flex:"1"},label:"Amount"},null,8,["modelValue","currency"])]),_:1})]),_:1}),l(te,{class:"q-my-md q-mr-md q-ml-md"},{default:x(()=>[i.value.debts.length===2?(V(),N(A,{key:0,class:"column items-center"},{default:x(()=>[l($e,{class:"full-width"},{label:x(()=>[l(B,{split:F.value===1,payer:i.value.payer,"you-idx":u(v),"other-name":u(t).getName(u(c)),currency:i.value.currency,amount:i.value.amount,"reference-currency":u(t).referenceCurrency},null,8,["split","payer","you-idx","other-name","currency","amount","reference-currency"])]),default:x(()=>[l(ie,null,{default:x(()=>[L((V(),N(G,{clickable:"",class:"bg-white",onClick:s[6]||(s[6]=b=>I(0))},{default:x(()=>[l($,null,{default:x(()=>[l(B,{split:"",payer:u(v),"you-idx":u(v),"other-name":u(t).getName(u(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[z]]),L((V(),N(G,{clickable:"",class:"bg-grey-3",onClick:s[7]||(s[7]=b=>I(1))},{default:x(()=>[l($,null,{default:x(()=>[l(B,{payer:u(v),"you-idx":u(v),"other-name":u(t).getName(u(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[z]]),L((V(),N(G,{clickable:"",class:"bg-white",onClick:s[8]||(s[8]=b=>I(2))},{default:x(()=>[l($,null,{default:x(()=>[l(B,{split:"",payer:u(g),"you-idx":u(v),"other-name":u(t).getName(u(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[z]]),L((V(),N(G,{clickable:"",class:"bg-grey-3",onClick:s[9]||(s[9]=b=>I(3))},{default:x(()=>[l($,null,{default:x(()=>[l(B,{payer:u(g),"you-idx":u(v),"other-name":u(t).getName(u(c)),currency:i.value.currency,amount:i.value.amount},null,8,["payer","you-idx","other-name","currency","amount"])]),_:1})]),_:1})),[[z]])]),_:1})]),_:1})]),_:1})):j("",!0),i.value.debts.length>2?(V(),N(A,{key:1,class:"row justify-center items-center no-wrap"},{default:x(()=>[l(ne,{class:"col-auto q-mr-sm",modelValue:f.value,"onUpdate:modelValue":s[10]||(s[10]=b=>f.value=b),people:u(t).currentSheet.people,"sorted-people":u(t).currentSheetPeople,"fixed-label":"Payer",dense:""},null,8,["modelValue","people","sorted-people"]),l(M,{class:"col-auto q-mr-sm",icon:"swap_horiz",onClick:o}),l(ne,{class:"col-auto",modelValue:d.value,"onUpdate:modelValue":s[11]||(s[11]=b=>d.value=b),people:u(t).currentSheet.people,"sorted-people":u(t).currentSheetPeople,"fixed-label":"Debtor",dense:""},null,8,["modelValue","people","sorted-people"])]),_:1})):j("",!0),l(A,{class:"row justify-center items-center"},{default:x(()=>[l(M,{flat:"",icon:"done",label:"Cancel",onClick:k,class:"q-mr-md bg-red text-white","aria-label":"Save"}),l(M,{flat:"",icon:"done",label:"Confirm",onClick:k,class:"bg-secondary text-white","aria-label":"Save"})]),_:1})]),_:1}),l(A,null,{default:x(()=>s[15]||(s[15]=[T("div",{class:"row text-bold items-center no-wrap"},[T("div",{style:{flex:"0 0 5%","text-align":"left"},class:"q-ml-sm q-mr-md"}," Payer "),T("div",{style:{flex:"1 0 30%","text-align":"left"}},"Person"),T("div",{style:{flex:"0 0 10%","text-align":"center"}},"Owes"),T("div",{style:{flex:"0 0 32%","text-align":"right"}},"Amount")],-1)])),_:1}),l(ie,{class:"q-my-md q-mr-md q-ml-md"},{default:x(()=>[(V(!0),R(W,null,Se(u(t).currentSheetPeople,(b,S)=>L((V(),N(G,{key:S,class:Ve([S%2===0?"bg-grey-1":"bg-white","row no-wrap items-center"])},{default:x(()=>[l($,{side:"",style:{flex:"0 0 5%","text-align":"left"}},{default:x(()=>[l(Qe,{modelValue:i.value.payer,"onUpdate:modelValue":[s[12]||(s[12]=_=>i.value.payer=_),s[13]||(s[13]=_=>w(!1))],val:S,dense:""},null,8,["modelValue","val"])]),_:2},1024),l($,{style:{flex:"1 0 50%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","text-align":"right"}},{default:x(()=>[l(Ae,{id:b},null,8,["id"])]),_:2},1024),l($,{side:"",style:{flex:"0 0 5%","text-align":"center","margin-right":"6px"}},{default:x(()=>[l(Me,{modelValue:i.value.debts[S].isDebtor,"onUpdate:modelValue":[_=>i.value.debts[S].isDebtor=_,s[14]||(s[14]=_=>w(!0))],dense:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l($,{side:"",style:{flex:"0 0 35%"}},{default:x(()=>[l(ae,{modelValue:i.value.debts[S].owedAmount,"onUpdate:modelValue":_=>i.value.debts[S].owedAmount=_,currency:i.value.currency,dense:"",style:{width:"auto","min-width":"4ch"},onBlur:_=>C(S)},null,8,["modelValue","onUpdate:modelValue","currency","onBlur"])]),_:2},1024)]),_:2},1032,["class"])),[[De,u(t).currentSheet.people[b].active||h.value||i.value.payer===S||i.value.debts[S].owedAmount!==0||i.value.debts[S].isDebtor]])),128))]),_:1})]),_:1})],64))}};export{gt as default};
